#ifdef _MSC_VER
#pragma warning(disable : 4305)
#pragma warning(disable : 4244)
#pragma warning(disable : 4838)
#endif

#include <assert.h>
#include <cstdlib>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#ifdef _MSC_VER
#define _USE_MATH_DEFINES
#endif
#include "track.h"
#include <math.h>

//       y
// z     .     x
//    .  .  .
//       .
//

enum
{
	SPRITE_GROUP_ORTHOGONAL=1,
	SPRITE_GROUP_DIAGONAL=2,
	SPRITE_GROUP_TURN=4,
	SPRITE_GROUP_INLINE_TWIST=8,
	SPRITE_GROUP_CORKSCREW=16,
	SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL=32,
	SPRITE_GROUP_ZERO_G_ROLLS_DIAGONAL=64,
	SPRITE_GROUP_ZERO_G_ROLLS_OTHER=128,
	SPRITE_GROUP_DIVE_LOOP=256,
};

#define SPRITE_GROUP_BASE (SPRITE_GROUP_ORTHOGONAL|SPRITE_GROUP_DIAGONAL|SPRITE_GROUP_TURN)

typedef struct
	{
	int yaw_sprite;
	int pitch_sprite;
	int bank_sprite;
	float yaw;
	float pitch;
	float roll;
	}sprite_rotation_t;

typedef struct
	{
	int x;
	int y;
	int z;
	int yaw_sprite;
	int pitch_sprite;
	int bank_sprite;
	}subposition_t;

#define MAX_SUBPOSITION_POINTS 1024

#define Y(i) (M_PI*i/16.0)

#define M_PI_6 (M_PI/6.0)
#define M_PI_8 (M_PI/8.0)
#define M_PI_12 (M_PI/12.0)

#define CORKSCREW_ANGLE_1 2.0*M_PI_12
#define CORKSCREW_ANGLE_2 4.0*M_PI_12
#define CORKSCREW_ANGLE_3 M_PI_2
#define CORKSCREW_ANGLE_4 8.0*M_PI_12
#define CORKSCREW_ANGLE_5 10.0*M_PI_12
#define G 0.387596687     // atan(1/sqrt(6)) //22 degrees (2 up,6 down)
#define S 1.02132908      // atan(4/sqrt(6)) //58.5 degrees (4 up,8 down)
#define V (0.5*M_PI)    //90 degrees
#define FG (0.5*G)      //11 degrees (1 up,5 down)
#define GS (0.5*(G+S))//40 degrees (3 up,7 down)
#define SV (0.5*(V+S))//74 degrees
#define GD 0.281034902    // atan(1/sqrt(12)) //16 degrees
#define FGD (0.5*GD)    //8 degrees
#define SD 0.857071948    // atan(4/sqrt(12)) //49 degrees

#define CRY(angle) (-atan2(0.5*(1-cos(angle)),1-0.5*(1-cos(angle))))
#define CRP(angle) (-asin(-sin(angle)/sqrt(2.0)))
#define CRR(angle) (atan2(sin(angle)/sqrt(2.0),cos(angle)))

#define CLY(angle) (-CRY((angle)))
#define CLP(angle) (-CRP(-(angle)))
#define CLR(angle) (-CRR((angle)))



/*
Pitch angle reference

0	|Flat
1	|Flat to gentle up
2	|Gentle up
3	|Gentle to steep up
4	|Steep up
5	|Flat to gentle down
6	|Gentle down
7	|Gentle to steep down
8	|Steep down
9	|Steep to vertical up
10	|Vertical up
11	|105 degree up
12	|120 degree up
13	|135 degree up
14	|150 degree up
15	|165 degree up
16	|180 degree up (fully inverted)
17	|Steep to vertical down
18	|Vertical down
19	|105 degree down
20	|120 degree down
21	|135 degree down
22	|150 degree down
23	|165 degree down
50 	|Flat to gentle diagonal up
51 	|Gentle diagonal up
52 	|Steep diagonal up
53 	|Flat to gentle diagonal down
54 	|Gentle diagonal down
55 	|Steep diagonal down


Bank angle reference

0	|Flat
1	|22.5 degree bank left
2	|45 degree bank left
3	|22.5 degree bank right
4	|45 degree bank right
5	|67.5 degree bank left
6	|90 degree bank left
7	|112.5 degree bank left
8	|135 degree bank left
9	|157.5 degree bank left
10	|67.5 degree bank right
11	|90 degree bank left
12	|112.5 degree bank right
13	|135 degree bank left
14	|157.5 degree bank right
*/















const char* pitch_names[]={"flat","up12","up25","up42","up60","down12","down25","down42","down60","up75","up90","up105","up120","up135","up150","up165","inverted","down75","down90","down105","down120","down135","down150","down165","","","","","","","","","","","","","","","","","","","","","","","","","","","up8","up16","up50","down8","down16","down50"};
const char* bank_names[]={"unbanked","left22","left45","right22","right45","left67","left90","left112","left135","left157","right67","right90","right112","right135","right157"};

//float pitch_angles[]={0,FG,G,GS,S,-FG,-G,-GS,-S,SV,V,V+1*M_PI_12,V+2*M_PI_12,V+3*M_PI_12,V+4*M_PI_12,V+5*M_PI_12,V+6*M_PI_12,-SV,-V,-V-1*M_PI_12,-V-2*M_PI_12,-V-3*M_PI_12,-V-4*M_PI_12,-V-5*M_PI_12,FGD,GD,SD,-FGD,-GD,-SD};
float pitch_angles[]={0,FG,G,GS,S,-FG,-G,-GS,-S,SV,V,-SV,-V,FGD,GD,SD,-FGD,-GD,-SD};
int pitch_numbers[]={0,1,2,3,4,5,6,7,8,9,10,17,18,50,51,52,53,54,55};

float bank_angles[]={0,M_PI_8,M_PI_4,-M_PI_8,-M_PI_4,3*M_PI_8,4*M_PI_8,5*M_PI_8,6*M_PI_8,7*M_PI_8,-3*M_PI_8,-4*M_PI_8,-5*M_PI_8,-6*M_PI_8,-7*M_PI_8};


//SPST
const sprite_rotation_t orthogonal_sprite_rotations[176]={
    //Flat sprites
    {0,0,0,Y(0),0.0,0.0},
    {8,0,0,Y(8),0.0,0.0},
    {16,0,0,Y(16),0.0,0.0},
    {24,0,0,Y(24),0.0,0.0},
    //Gentle slope sprites
    {0,1,0,Y(0),FG,0.0},
    {8,1,0,Y(8),FG,0.0},
    {16,1,0,Y(16),FG,0.0},
    {24,1,0,Y(24),FG,0.0},
    {0,5,0,Y(0),-FG,0.0},
    {8,5,0,Y(8),-FG,0.0},
    {16,5,0,Y(16),-FG,0.0},
    {24,5,0,Y(24),-FG,0.0},
    {0,2,0,Y(0),G,0.0},
    {8,2,0,Y(8),G,0.0},
    {16,2,0,Y(16),G,0.0},
    {24,2,0,Y(24),G,0.0},
    {0,6,0,Y(0),-G,0.0},
    {8,6,0,Y(8),-G,0.0},
    {16,6,0,Y(16),-G,0.0},
    {24,6,0,Y(24),-G,0.0},
    //Steep slope sprites
    {0,3,0,Y(0),GS,0.0},
    {8,3,0,Y(8),GS,0.0},
    {16,3,0,Y(16),GS,0.0},
    {24,3,0,Y(24),GS,0.0},
    {0,7,0,Y(0),-GS,0.0},
    {8,7,0,Y(8),-GS,0.0},
    {16,7,0,Y(16),-GS,0.0},
    {24,7,0,Y(24),-GS,0.0},
    {0,4,0,Y(0),S,0.0},
    {8,4,0,Y(8),S,0.0},
    {16,4,0,Y(16),S,0.0},
    {24,4,0,Y(24),S,0.0},
    {0,8,0,Y(0),-S,0.0},
    {8,8,0,Y(8),-S,0.0},
    {16,8,0,Y(16),-S,0.0},
    {24,8,0,Y(24),-S,0.0},
    //Vertical slope sprites
    {0,9,0,Y(0),SV,0.0},
    {8,9,0,Y(8),SV,0.0},
    {16,9,0,Y(16),SV,0.0},
    {24,9,0,Y(24),SV,0.0},
    {0,17,0,Y(0),-SV,0.0},
    {8,17,0,Y(8),-SV,0.0},
    {16,17,0,Y(16),-SV,0.0},
    {24,17,0,Y(24),-SV,0.0},
    {0,10,0,Y(0),V,0.0},
    {8,10,0,Y(8),V,0.0},
    {16,10,0,Y(16),V,0.0},
    {24,10,0,Y(24),V,0.0},
    {0,18,0,Y(0),-V,0.0},
    {8,18,0,Y(8),-V,0.0},
    {16,18,0,Y(16),-V,0.0},
    {24,18,0,Y(24),-V,0.0},
    {0,11,0,Y(0),V+1*M_PI_12,0.0},
    {8,11,0,Y(8),V+1*M_PI_12,0.0},
    {16,11,0,Y(16),V+1*M_PI_12,0.0},
    {24,11,0,Y(24),V+1*M_PI_12,0.0},
    {0,12,0,Y(0),V+2*M_PI_12,0.0},
    {8,12,0,Y(8),V+2*M_PI_12,0.0},
    {16,12,0,Y(16),V+2*M_PI_12,0.0},
    {24,12,0,Y(24),V+2*M_PI_12,0.0},
    {0,13,0,Y(0),V+3*M_PI_12,0.0},
    {8,13,0,Y(8),V+3*M_PI_12,0.0},
    {16,13,0,Y(16),V+3*M_PI_12,0.0},
    {24,13,0,Y(24),V+3*M_PI_12,0.0},
    {0,14,0,Y(0),V+4*M_PI_12,0.0},
    {8,14,0,Y(8),V+4*M_PI_12,0.0},
    {16,14,0,Y(16),V+4*M_PI_12,0.0},
    {24,14,0,Y(24),V+4*M_PI_12,0.0},
    {0,15,0,Y(0),V+5*M_PI_12,0.0},
    {8,15,0,Y(8),V+5*M_PI_12,0.0},
    {16,15,0,Y(16),V+5*M_PI_12,0.0},
    {24,15,0,Y(24),V+5*M_PI_12,0.0},
    {0,16,0,Y(0),V+6*M_PI_12,0.0},
    {8,16,0,Y(8),V+6*M_PI_12,0.0},
    {16,16,0,Y(16),V+6*M_PI_12,0.0},
    {24,16,0,Y(24),V+6*M_PI_12,0.0},
    {0,19,0,Y(0),-V-1*M_PI_12,0.0},
    {8,19,0,Y(8),-V-1*M_PI_12,0.0},
    {16,19,0,Y(16),-V-1*M_PI_12,0.0},
    {24,19,0,Y(24),-V-1*M_PI_12,0.0},
    {0,20,0,Y(0),-V-2*M_PI_12,0.0},
    {8,20,0,Y(8),-V-2*M_PI_12,0.0},
    {16,20,0,Y(16),-V-2*M_PI_12,0.0},
    {24,20,0,Y(24),-V-2*M_PI_12,0.0},
    {0,21,0,Y(0),-V-3*M_PI_12,0.0},
    {8,21,0,Y(8),-V-3*M_PI_12,0.0},
    {16,21,0,Y(16),-V-3*M_PI_12,0.0},
    {24,21,0,Y(24),-V-3*M_PI_12,0.0},
    {0,22,0,Y(0),-V-4*M_PI_12,0.0},
    {8,22,0,Y(8),-V-4*M_PI_12,0.0},
    {16,22,0,Y(16),-V-4*M_PI_12,0.0},
    {24,22,0,Y(24),-V-4*M_PI_12,0.0},
    {0,23,0,Y(0),-V-5*M_PI_12,0.0},
    {8,23,0,Y(8),-V-5*M_PI_12,0.0},
    {16,23,0,Y(16),-V-5*M_PI_12,0.0},
    {24,23,0,Y(24),-V-5*M_PI_12,0.0},
    //Banked turn sprites
    {0,0,1,Y(0),0,M_PI_8},
    {8,0,1,Y(8),0,M_PI_8},
    {16,0,1,Y(16),0,M_PI_8},
    {24,0,1,Y(24),0,M_PI_8},
    {0,0,3,Y(0),0,-M_PI_8},
    {8,0,3,Y(8),0,-M_PI_8},
    {16,0,3,Y(16),0,-M_PI_8},
    {24,0,3,Y(24),0,-M_PI_8},
    {0,0,2,Y(0),0,M_PI_4},
    {8,0,2,Y(8),0,M_PI_4},
    {16,0,2,Y(16),0,M_PI_4},
    {24,0,2,Y(24),0,M_PI_4},
    {0,0,4,Y(0),0,-M_PI_4},
    {8,0,4,Y(8),0,-M_PI_4},
    {16,0,4,Y(16),0,-M_PI_4},
    {24,0,4,Y(24),0,-M_PI_4},
    //Slope bank transition
    {0,1,1,Y(0),FG,M_PI_8},
    {8,1,1,Y(8),FG,M_PI_8},
    {16,1,1,Y(16),FG,M_PI_8},
    {24,1,1,Y(24),FG,M_PI_8},
    {0,1,3,Y(0),FG,-M_PI_8},
    {8,1,3,Y(8),FG,-M_PI_8},
    {16,1,3,Y(16),FG,-M_PI_8},
    {24,1,3,Y(24),FG,-M_PI_8},
    {0,5,1,Y(0),-FG,M_PI_8},
    {8,5,1,Y(8),-FG,M_PI_8},
    {16,5,1,Y(16),-FG,M_PI_8},
    {24,5,1,Y(24),-FG,M_PI_8},
    {0,5,3,Y(0),-FG,-M_PI_8},
    {8,5,3,Y(8),-FG,-M_PI_8},
    {16,5,3,Y(16),-FG,-M_PI_8},
    {24,5,3,Y(24),-FG,-M_PI_8},
    //Sloped bank transition
    {0,2,1,Y(0),G,M_PI_8},
    {8,2,1,Y(8),G,M_PI_8},
    {16,2,1,Y(16),G,M_PI_8},
    {24,2,1,Y(24),G,M_PI_8},
    {0,2,3,Y(0),G,-M_PI_8},
    {8,2,3,Y(8),G,-M_PI_8},
    {16,2,3,Y(16),G,-M_PI_8},
    {24,2,3,Y(24),G,-M_PI_8},
    {0,6,1,Y(0),-G,M_PI_8},
    {8,6,1,Y(8),-G,M_PI_8},
    {16,6,1,Y(16),-G,M_PI_8},
    {24,6,1,Y(24),-G,M_PI_8},
    {0,6,3,Y(0),-G,-M_PI_8},
    {8,6,3,Y(8),-G,-M_PI_8},
    {16,6,3,Y(16),-G,-M_PI_8},
    {24,6,3,Y(24),-G,-M_PI_8},
    //Sloped banked turn
    {0,2,2,Y(0),G,M_PI_4},
    {8,2,2,Y(8),G,M_PI_4},
    {16,2,2,Y(16),G,M_PI_4},
    {24,2,2,Y(24),G,M_PI_4},
    {0,2,4,Y(0),G,-M_PI_4},
    {8,2,4,Y(8),G,-M_PI_4},
    {16,2,4,Y(16),G,-M_PI_4},
    {24,2,4,Y(24),G,-M_PI_4},
    {0,6,2,Y(0),-G,M_PI_4},
    {8,6,2,Y(8),-G,M_PI_4},
    {16,6,2,Y(16),-G,M_PI_4},
    {24,6,2,Y(24),-G,M_PI_4},
    {0,6,4,Y(0),-G,-M_PI_4},
    {8,6,4,Y(8),-G,-M_PI_4},
    {16,6,4,Y(16),-G,-M_PI_4},
    {24,6,4,Y(24),-G,-M_PI_4},
    //Banked slope transition
    {0,1,2,Y(0),FG,M_PI_4},
    {8,1,2,Y(8),FG,M_PI_4},
    {16,1,2,Y(16),FG,M_PI_4},
    {24,1,2,Y(24),FG,M_PI_4},
    {0,1,4,Y(0),FG,-M_PI_4},
    {8,1,4,Y(8),FG,-M_PI_4},
    {16,1,4,Y(16),FG,-M_PI_4},
    {24,1,4,Y(24),FG,-M_PI_4},
    {0,5,2,Y(0),-FG,M_PI_4},
    {8,5,2,Y(8),-FG,M_PI_4},
    {16,5,2,Y(16),-FG,M_PI_4},
    {24,5,2,Y(24),-FG,M_PI_4},
    {0,5,4,Y(0),-FG,-M_PI_4},
    {8,5,4,Y(8),-FG,-M_PI_4},
    {16,5,4,Y(16),-FG,-M_PI_4},
    {24,5,4,Y(24),-FG,-M_PI_4}};

sprite_rotation_t diagonal_sprite_rotations[172]={
    //Flat sprites
    {4,0,0,Y(4),0.0,0.0},
    {12,0,0,Y(12),0.0,0.0},
    {20,0,0,Y(20),0.0,0.0},
    {28,0,0,Y(28),0.0,0.0},
    //Gentle slope sprites
    {4,2,0,Y(4),G,0.0},
    {12,2,0,Y(12),G,0.0},
    {20,2,0,Y(20),G,0.0},
    {28,2,0,Y(28),G,0.0},
    {4,6,0,Y(4),-G,0.0},
    {12,6,0,Y(12),-G,0.0},
    {20,6,0,Y(20),-G,0.0},
    {28,6,0,Y(28),-G,0.0},
    //Steep slope sprites
    {4,3,0,Y(4),GS,0.0},
    {12,3,0,Y(12),GS,0.0},
    {20,3,0,Y(20),GS,0.0},
    {28,3,0,Y(28),GS,0.0},
    {4,7,0,Y(4),-GS,0.0},
    {12,7,0,Y(12),-GS,0.0},
    {20,7,0,Y(20),-GS,0.0},
    {28,7,0,Y(28),-GS,0.0},
    {4,4,0,Y(4),S,0.0},
    {12,4,0,Y(12),S,0.0},
    {20,4,0,Y(20),S,0.0},
    {28,4,0,Y(28),S,0.0},
    {4,8,0,Y(4),-S,0.0},
    {12,8,0,Y(12),-S,0.0},
    {20,8,0,Y(20),-S,0.0},
    {28,8,0,Y(28),-S,0.0},
    //Vertical slope sprites
    {4,10,0,Y(4),V,0.0},
    {12,10,0,Y(12),V,0.0},
    {20,10,0,Y(20),V,0.0},
    {28,10,0,Y(28),V,0.0},
    {4,18,0,Y(4),-V,0.0},
    {12,18,0,Y(12),-V,0.0},
    {20,18,0,Y(20),-V,0.0},
    {28,18,0,Y(28),-V,0.0},
    //Diagonal sprites
    {4,50,0,Y(4),FGD,0.0},
    {12,50,0,Y(12),FGD,0.0},
    {20,50,0,Y(20),FGD,0.0},
    {28,50,0,Y(28),FGD,0.0},
    {4,53,0,Y(4),-FGD,0.0},
    {12,53,0,Y(12),-FGD,0.0},
    {20,53,0,Y(20),-FGD,0.0},
    {28,53,0,Y(28),-FGD,0.0},
    {4,51,0,Y(4),GD,0.0},
    {12,51,0,Y(12),GD,0.0},
    {20,51,0,Y(20),GD,0.0},
    {28,51,0,Y(28),GD,0.0},
    {4,54,0,Y(4),-GD,0.0},
    {12,54,0,Y(12),-GD,0.0},
    {20,54,0,Y(20),-GD,0.0},
    {28,54,0,Y(28),-GD,0.0},
    {4,52,0,Y(4),SD,0.0},
    {12,52,0,Y(12),SD,0.0},
    {20,52,0,Y(20),SD,0.0},
    {28,52,0,Y(28),SD,0.0},
    {4,55,0,Y(4),-SD,0.0},
    {12,55,0,Y(12),-SD,0.0},
    {20,55,0,Y(20),-SD,0.0},
    {28,55,0,Y(28),-SD,0.0},
    //Banked turn sprites
    {4,0,1,Y(4),0,M_PI_8},
    {12,0,1,Y(12),0,M_PI_8},
    {20,0,1,Y(20),0,M_PI_8},
    {28,0,1,Y(28),0,M_PI_8},
    {4,0,3,Y(4),0,-M_PI_8},
    {12,0,3,Y(12),0,-M_PI_8},
    {20,0,3,Y(20),0,-M_PI_8},
    {28,0,3,Y(28),0,-M_PI_8},
    {4,0,2,Y(4),0,M_PI_4},
    {12,0,2,Y(12),0,M_PI_4},
    {20,0,2,Y(20),0,M_PI_4},
    {28,0,2,Y(28),0,M_PI_4},
    {4,0,4,Y(4),0,-M_PI_4},
    {12,0,4,Y(12),0,-M_PI_4},
    {20,0,4,Y(20),0,-M_PI_4},
    {28,0,4,Y(28),0,-M_PI_4},
    //Slope bank transition
    {4,1,1,Y(4),FG,M_PI_8},
    {12,1,1,Y(12),FG,M_PI_8},
    {20,1,1,Y(20),FG,M_PI_8},
    {28,1,1,Y(28),FG,M_PI_8},
    {4,1,3,Y(4),FG,-M_PI_8},
    {12,1,3,Y(12),FG,-M_PI_8},
    {20,1,3,Y(20),FG,-M_PI_8},
    {28,1,3,Y(28),FG,-M_PI_8},
    {4,5,1,Y(4),-FG,M_PI_8},
    {12,5,1,Y(12),-FG,M_PI_8},
    {20,5,1,Y(20),-FG,M_PI_8},
    {28,5,1,Y(28),-FG,M_PI_8},
    {4,5,3,Y(4),-FG,-M_PI_8},
    {12,5,3,Y(12),-FG,-M_PI_8},
    {20,5,3,Y(20),-FG,-M_PI_8},
    {28,5,3,Y(28),-FG,-M_PI_8},
    //Diagonal bank transition
    {4,50,1,Y(4),FGD,M_PI_8},
    {12,50,1,Y(12),FGD,M_PI_8},
    {20,50,1,Y(20),FGD,M_PI_8},
    {28,50,1,Y(28),FGD,M_PI_8},
    {4,50,3,Y(4),FGD,-M_PI_8},
    {12,50,3,Y(12),FGD,-M_PI_8},
    {20,50,3,Y(20),FGD,-M_PI_8},
    {28,50,3,Y(28),FGD,-M_PI_8},
    {4,53,1,Y(4),-FGD,M_PI_8},
    {12,53,1,Y(12),-FGD,M_PI_8},
    {20,53,1,Y(20),-FGD,M_PI_8},
    {28,53,1,Y(28),-FGD,M_PI_8},
    {4,53,3,Y(4),-FGD,-M_PI_8},
    {12,53,3,Y(12),-FGD,-M_PI_8},
    {20,53,3,Y(20),-FGD,-M_PI_8},
    {28,53,3,Y(28),-FGD,-M_PI_8},
    //Diagonal sloped bank transition
    {4,50,2,Y(4),FGD,M_PI_4},
    {12,50,2,Y(12),FGD,M_PI_4},
    {20,50,2,Y(20),FGD,M_PI_4},
    {28,50,2,Y(28),FGD,M_PI_4},
    {4,50,4,Y(4),FGD,-M_PI_4},
    {12,50,4,Y(12),FGD,-M_PI_4},
    {20,50,4,Y(20),FGD,-M_PI_4},
    {28,50,4,Y(28),FGD,-M_PI_4},
    {4,53,2,Y(4),-FGD,M_PI_4},
    {12,53,2,Y(12),-FGD,M_PI_4},
    {20,53,2,Y(20),-FGD,M_PI_4},
    {28,53,2,Y(28),-FGD,M_PI_4},
    {4,53,4,Y(4),-FGD,-M_PI_4},
    {12,53,4,Y(12),-FGD,-M_PI_4},
    {20,53,4,Y(20),-FGD,-M_PI_4},
    {28,53,4,Y(28),-FGD,-M_PI_4},
    {4,51,1,Y(4),GD,M_PI_8},
    {12,51,1,Y(12),GD,M_PI_8},
    {20,51,1,Y(20),GD,M_PI_8},
    {28,51,1,Y(28),GD,M_PI_8},
    {4,51,3,Y(4),GD,-M_PI_8},
    {12,51,3,Y(12),GD,-M_PI_8},
    {20,51,3,Y(20),GD,-M_PI_8},
    {28,51,3,Y(28),GD,-M_PI_8},
    {4,54,1,Y(4),-GD,M_PI_8},
    {12,54,1,Y(12),-GD,M_PI_8},
    {20,54,1,Y(20),-GD,M_PI_8},
    {28,54,1,Y(28),-GD,M_PI_8},
    {4,54,3,Y(4),-GD,-M_PI_8},
    {12,54,3,Y(12),-GD,-M_PI_8},
    {20,54,3,Y(20),-GD,-M_PI_8},
    {28,54,3,Y(28),-GD,-M_PI_8},
    {4,51,2,Y(4),GD,M_PI_4},
    {12,51,2,Y(12),GD,M_PI_4},
    {20,51,2,Y(20),GD,M_PI_4},
    {28,51,2,Y(28),GD,M_PI_4},
    {4,51,4,Y(4),GD,-M_PI_4},
    {12,51,4,Y(12),GD,-M_PI_4},
    {20,51,4,Y(20),GD,-M_PI_4},
    {28,51,4,Y(28),GD,-M_PI_4},
    {4,54,2,Y(4),-GD,M_PI_4},
    {12,54,2,Y(12),-GD,M_PI_4},
    {20,54,2,Y(20),-GD,M_PI_4},
    {28,54,2,Y(28),-GD,M_PI_4},
    {4,54,4,Y(4),-GD,-M_PI_4},
    {12,54,4,Y(12),-GD,-M_PI_4},
    {20,54,4,Y(20),-GD,-M_PI_4},
    {28,54,4,Y(28),-GD,-M_PI_4},
    //Sloped banked turn
    {4,2,2,Y(4),G,M_PI_4},
    {12,2,2,Y(12),G,M_PI_4},
    {20,2,2,Y(20),G,M_PI_4},
    {28,2,2,Y(28),G,M_PI_4},
    {4,2,4,Y(4),G,-M_PI_4},
    {12,2,4,Y(12),G,-M_PI_4},
    {20,2,4,Y(20),G,-M_PI_4},
    {28,2,4,Y(28),G,-M_PI_4},
    {4,6,2,Y(4),-G,M_PI_4},
    {12,6,2,Y(12),-G,M_PI_4},
    {20,6,2,Y(20),-G,M_PI_4},
    {28,6,2,Y(28),-G,M_PI_4},
    {4,6,4,Y(4),-G,-M_PI_4},
    {12,6,4,Y(12),-G,-M_PI_4},
    {20,6,4,Y(20),-G,-M_PI_4},
    {28,6,4,Y(28),-G,-M_PI_4},
};

sprite_rotation_t turn_sprite_rotations[408]={
    //Flat sprites
    {1,0,0,Y(1),0.0,0.0},
    {2,0,0,Y(2),0.0,0.0},
    {3,0,0,Y(3),0.0,0.0},
    {5,0,0,Y(5),0.0,0.0},
    {6,0,0,Y(6),0.0,0.0},
    {7,0,0,Y(7),0.0,0.0},
    {9,0,0,Y(9),0.0,0.0},
    {10,0,0,Y(10),0.0,0.0},
    {11,0,0,Y(11),0.0,0.0},
    {13,0,0,Y(13),0.0,0.0},
    {14,0,0,Y(14),0.0,0.0},
    {15,0,0,Y(15),0.0,0.0},
    {17,0,0,Y(17),0.0,0.0},
    {18,0,0,Y(18),0.0,0.0},
    {19,0,0,Y(19),0.0,0.0},
    {21,0,0,Y(21),0.0,0.0},
    {22,0,0,Y(22),0.0,0.0},
    {23,0,0,Y(23),0.0,0.0},
    {25,0,0,Y(25),0.0,0.0},
    {26,0,0,Y(26),0.0,0.0},
    {27,0,0,Y(27),0.0,0.0},
    {29,0,0,Y(29),0.0,0.0},
    {30,0,0,Y(30),0.0,0.0},
    {31,0,0,Y(31),0.0,0.0},
    //Gentle slope sprites
    {1,2,0,Y(1),G,0.0},
    {2,2,0,Y(2),G,0.0},
    {3,2,0,Y(3),G,0.0},
    {5,2,0,Y(5),G,0.0},
    {6,2,0,Y(6),G,0.0},
    {7,2,0,Y(7),G,0.0},
    {9,2,0,Y(9),G,0.0},
    {10,2,0,Y(10),G,0.0},
    {11,2,0,Y(11),G,0.0},
    {13,2,0,Y(13),G,0.0},
    {14,2,0,Y(14),G,0.0},
    {15,2,0,Y(15),G,0.0},
    {17,2,0,Y(17),G,0.0},
    {18,2,0,Y(18),G,0.0},
    {19,2,0,Y(19),G,0.0},
    {21,2,0,Y(21),G,0.0},
    {22,2,0,Y(22),G,0.0},
    {23,2,0,Y(23),G,0.0},
    {25,2,0,Y(25),G,0.0},
    {26,2,0,Y(26),G,0.0},
    {27,2,0,Y(27),G,0.0},
    {29,2,0,Y(29),G,0.0},
    {30,2,0,Y(30),G,0.0},
    {31,2,0,Y(31),G,0.0},
    {1,6,0,Y(1),-G,0.0},
    {2,6,0,Y(2),-G,0.0},
    {3,6,0,Y(3),-G,0.0},
    {5,6,0,Y(5),-G,0.0},
    {6,6,0,Y(6),-G,0.0},
    {7,6,0,Y(7),-G,0.0},
    {9,6,0,Y(9),-G,0.0},
    {10,6,0,Y(10),-G,0.0},
    {11,6,0,Y(11),-G,0.0},
    {13,6,0,Y(13),-G,0.0},
    {14,6,0,Y(14),-G,0.0},
    {15,6,0,Y(15),-G,0.0},
    {17,6,0,Y(17),-G,0.0},
    {18,6,0,Y(18),-G,0.0},
    {19,6,0,Y(19),-G,0.0},
    {21,6,0,Y(21),-G,0.0},
    {22,6,0,Y(22),-G,0.0},
    {23,6,0,Y(23),-G,0.0},
    {25,6,0,Y(25),-G,0.0},
    {26,6,0,Y(26),-G,0.0},
    {27,6,0,Y(27),-G,0.0},
    {29,6,0,Y(29),-G,0.0},
    {30,6,0,Y(30),-G,0.0},
    {31,6,0,Y(31),-G,0.0},
    //Steep slope sprites
    {1,4,0,Y(1),S,0.0},
    {2,4,0,Y(2),S,0.0},
    {3,4,0,Y(3),S,0.0},
    {5,4,0,Y(5),S,0.0},
    {6,4,0,Y(6),S,0.0},
    {7,4,0,Y(7),S,0.0},
    {9,4,0,Y(9),S,0.0},
    {10,4,0,Y(10),S,0.0},
    {11,4,0,Y(11),S,0.0},
    {13,4,0,Y(13),S,0.0},
    {14,4,0,Y(14),S,0.0},
    {15,4,0,Y(15),S,0.0},
    {17,4,0,Y(17),S,0.0},
    {18,4,0,Y(18),S,0.0},
    {19,4,0,Y(19),S,0.0},
    {21,4,0,Y(21),S,0.0},
    {22,4,0,Y(22),S,0.0},
    {23,4,0,Y(23),S,0.0},
    {25,4,0,Y(25),S,0.0},
    {26,4,0,Y(26),S,0.0},
    {27,4,0,Y(27),S,0.0},
    {29,4,0,Y(29),S,0.0},
    {30,4,0,Y(30),S,0.0},
    {31,4,0,Y(31),S,0.0},
    {1,8,0,Y(1),-S,0.0},
    {2,8,0,Y(2),-S,0.0},
    {3,8,0,Y(3),-S,0.0},
    {5,8,0,Y(5),-S,0.0},
    {6,8,0,Y(6),-S,0.0},
    {7,8,0,Y(7),-S,0.0},
    {9,8,0,Y(9),-S,0.0},
    {10,8,0,Y(10),-S,0.0},
    {11,8,0,Y(11),-S,0.0},
    {13,8,0,Y(13),-S,0.0},
    {14,8,0,Y(14),-S,0.0},
    {15,8,0,Y(15),-S,0.0},
    {17,8,0,Y(17),-S,0.0},
    {18,8,0,Y(18),-S,0.0},
    {19,8,0,Y(19),-S,0.0},
    {21,8,0,Y(21),-S,0.0},
    {22,8,0,Y(22),-S,0.0},
    {23,8,0,Y(23),-S,0.0},
    {25,8,0,Y(25),-S,0.0},
    {26,8,0,Y(26),-S,0.0},
    {27,8,0,Y(27),-S,0.0},
    {29,8,0,Y(29),-S,0.0},
    {30,8,0,Y(30),-S,0.0},
    {31,8,0,Y(31),-S,0.0},
    //Vertical slope sprites
    {1,10,0,Y(1),V,0.0},
    {2,10,0,Y(2),V,0.0},
    {3,10,0,Y(3),V,0.0},
    {5,10,0,Y(5),V,0.0},
    {6,10,0,Y(6),V,0.0},
    {7,10,0,Y(7),V,0.0},
    {9,10,0,Y(9),V,0.0},
    {10,10,0,Y(10),V,0.0},
    {11,10,0,Y(11),V,0.0},
    {13,10,0,Y(13),V,0.0},
    {14,10,0,Y(14),V,0.0},
    {15,10,0,Y(15),V,0.0},
    {17,10,0,Y(17),V,0.0},
    {18,10,0,Y(18),V,0.0},
    {19,10,0,Y(19),V,0.0},
    {21,10,0,Y(21),V,0.0},
    {22,10,0,Y(22),V,0.0},
    {23,10,0,Y(23),V,0.0},
    {25,10,0,Y(25),V,0.0},
    {26,10,0,Y(26),V,0.0},
    {27,10,0,Y(27),V,0.0},
    {29,10,0,Y(29),V,0.0},
    {30,10,0,Y(30),V,0.0},
    {31,10,0,Y(31),V,0.0},
    {1,18,0,Y(1),-V,0.0},
    {2,18,0,Y(2),-V,0.0},
    {3,18,0,Y(3),-V,0.0},
    {5,18,0,Y(5),-V,0.0},
    {6,18,0,Y(6),-V,0.0},
    {7,18,0,Y(7),-V,0.0},
    {9,18,0,Y(9),-V,0.0},
    {10,18,0,Y(10),-V,0.0},
    {11,18,0,Y(11),-V,0.0},
    {13,18,0,Y(13),-V,0.0},
    {14,18,0,Y(14),-V,0.0},
    {15,18,0,Y(15),-V,0.0},
    {17,18,0,Y(17),-V,0.0},
    {18,18,0,Y(18),-V,0.0},
    {19,18,0,Y(19),-V,0.0},
    {21,18,0,Y(21),-V,0.0},
    {22,18,0,Y(22),-V,0.0},
    {23,18,0,Y(23),-V,0.0},
    {25,18,0,Y(25),-V,0.0},
    {26,18,0,Y(26),-V,0.0},
    {27,18,0,Y(27),-V,0.0},
    {29,18,0,Y(29),-V,0.0},
    {30,18,0,Y(30),-V,0.0},
    {31,18,0,Y(31),-V,0.0},
    {1,0,2,Y(1),0,M_PI_4},
    {2,0,2,Y(2),0,M_PI_4},
    {3,0,2,Y(3),0,M_PI_4},
    {5,0,2,Y(5),0,M_PI_4},
    {6,0,2,Y(6),0,M_PI_4},
    {7,0,2,Y(7),0,M_PI_4},
    {9,0,2,Y(9),0,M_PI_4},
    {10,0,2,Y(10),0,M_PI_4},
    {11,0,2,Y(11),0,M_PI_4},
    {13,0,2,Y(13),0,M_PI_4},
    {14,0,2,Y(14),0,M_PI_4},
    {15,0,2,Y(15),0,M_PI_4},
    {17,0,2,Y(17),0,M_PI_4},
    {18,0,2,Y(18),0,M_PI_4},
    {19,0,2,Y(19),0,M_PI_4},
    {21,0,2,Y(21),0,M_PI_4},
    {22,0,2,Y(22),0,M_PI_4},
    {23,0,2,Y(23),0,M_PI_4},
    {25,0,2,Y(25),0,M_PI_4},
    {26,0,2,Y(26),0,M_PI_4},
    {27,0,2,Y(27),0,M_PI_4},
    {29,0,2,Y(29),0,M_PI_4},
    {30,0,2,Y(30),0,M_PI_4},
    {31,0,2,Y(31),0,M_PI_4},
    {1,0,4,Y(1),0,-M_PI_4},
    {2,0,4,Y(2),0,-M_PI_4},
    {3,0,4,Y(3),0,-M_PI_4},
    {5,0,4,Y(5),0,-M_PI_4},
    {6,0,4,Y(6),0,-M_PI_4},
    {7,0,4,Y(7),0,-M_PI_4},
    {9,0,4,Y(9),0,-M_PI_4},
    {10,0,4,Y(10),0,-M_PI_4},
    {11,0,4,Y(11),0,-M_PI_4},
    {13,0,4,Y(13),0,-M_PI_4},
    {14,0,4,Y(14),0,-M_PI_4},
    {15,0,4,Y(15),0,-M_PI_4},
    {17,0,4,Y(17),0,-M_PI_4},
    {18,0,4,Y(18),0,-M_PI_4},
    {19,0,4,Y(19),0,-M_PI_4},
    {21,0,4,Y(21),0,-M_PI_4},
    {22,0,4,Y(22),0,-M_PI_4},
    {23,0,4,Y(23),0,-M_PI_4},
    {25,0,4,Y(25),0,-M_PI_4},
    {26,0,4,Y(26),0,-M_PI_4},
    {27,0,4,Y(27),0,-M_PI_4},
    {29,0,4,Y(29),0,-M_PI_4},
    {30,0,4,Y(30),0,-M_PI_4},
    {31,0,4,Y(31),0,-M_PI_4},
    //Slope bank transition
    {1,1,1,Y(1),FG,M_PI_8},
    {2,1,1,Y(2),FG,M_PI_8},
    {3,1,1,Y(3),FG,M_PI_8},
    {5,1,1,Y(5),FG,M_PI_8},
    {6,1,1,Y(6),FG,M_PI_8},
    {7,1,1,Y(7),FG,M_PI_8},
    {9,1,1,Y(9),FG,M_PI_8},
    {10,1,1,Y(10),FG,M_PI_8},
    {11,1,1,Y(11),FG,M_PI_8},
    {13,1,1,Y(13),FG,M_PI_8},
    {14,1,1,Y(14),FG,M_PI_8},
    {15,1,1,Y(15),FG,M_PI_8},
    {17,1,1,Y(17),FG,M_PI_8},
    {18,1,1,Y(18),FG,M_PI_8},
    {19,1,1,Y(19),FG,M_PI_8},
    {21,1,1,Y(21),FG,M_PI_8},
    {22,1,1,Y(22),FG,M_PI_8},
    {23,1,1,Y(23),FG,M_PI_8},
    {25,1,1,Y(25),FG,M_PI_8},
    {26,1,1,Y(26),FG,M_PI_8},
    {27,1,1,Y(27),FG,M_PI_8},
    {29,1,1,Y(29),FG,M_PI_8},
    {30,1,1,Y(30),FG,M_PI_8},
    {31,1,1,Y(31),FG,M_PI_8},
    {1,1,3,Y(1),FG,-M_PI_8},
    {2,1,3,Y(2),FG,-M_PI_8},
    {3,1,3,Y(3),FG,-M_PI_8},
    {5,1,3,Y(5),FG,-M_PI_8},
    {6,1,3,Y(6),FG,-M_PI_8},
    {7,1,3,Y(7),FG,-M_PI_8},
    {9,1,3,Y(9),FG,-M_PI_8},
    {10,1,3,Y(10),FG,-M_PI_8},
    {11,1,3,Y(11),FG,-M_PI_8},
    {13,1,3,Y(13),FG,-M_PI_8},
    {14,1,3,Y(14),FG,-M_PI_8},
    {15,1,3,Y(15),FG,-M_PI_8},
    {17,1,3,Y(17),FG,-M_PI_8},
    {18,1,3,Y(18),FG,-M_PI_8},
    {19,1,3,Y(19),FG,-M_PI_8},
    {21,1,3,Y(21),FG,-M_PI_8},
    {22,1,3,Y(22),FG,-M_PI_8},
    {23,1,3,Y(23),FG,-M_PI_8},
    {25,1,3,Y(25),FG,-M_PI_8},
    {26,1,3,Y(26),FG,-M_PI_8},
    {27,1,3,Y(27),FG,-M_PI_8},
    {29,1,3,Y(29),FG,-M_PI_8},
    {30,1,3,Y(30),FG,-M_PI_8},
    {31,1,3,Y(31),FG,-M_PI_8},
    {1,5,1,Y(1),-FG,M_PI_8},
    {2,5,1,Y(2),-FG,M_PI_8},
    {3,5,1,Y(3),-FG,M_PI_8},
    {5,5,1,Y(5),-FG,M_PI_8},
    {6,5,1,Y(6),-FG,M_PI_8},
    {7,5,1,Y(7),-FG,M_PI_8},
    {9,5,1,Y(9),-FG,M_PI_8},
    {10,5,1,Y(10),-FG,M_PI_8},
    {11,5,1,Y(11),-FG,M_PI_8},
    {13,5,1,Y(13),-FG,M_PI_8},
    {14,5,1,Y(14),-FG,M_PI_8},
    {15,5,1,Y(15),-FG,M_PI_8},
    {17,5,1,Y(17),-FG,M_PI_8},
    {18,5,1,Y(18),-FG,M_PI_8},
    {19,5,1,Y(19),-FG,M_PI_8},
    {21,5,1,Y(21),-FG,M_PI_8},
    {22,5,1,Y(22),-FG,M_PI_8},
    {23,5,1,Y(23),-FG,M_PI_8},
    {25,5,1,Y(25),-FG,M_PI_8},
    {26,5,1,Y(26),-FG,M_PI_8},
    {27,5,1,Y(27),-FG,M_PI_8},
    {29,5,1,Y(29),-FG,M_PI_8},
    {30,5,1,Y(30),-FG,M_PI_8},
    {31,5,1,Y(31),-FG,M_PI_8},
    {1,5,3,Y(1),-FG,-M_PI_8},
    {2,5,3,Y(2),-FG,-M_PI_8},
    {3,5,3,Y(3),-FG,-M_PI_8},
    {5,5,3,Y(5),-FG,-M_PI_8},
    {6,5,3,Y(6),-FG,-M_PI_8},
    {7,5,3,Y(7),-FG,-M_PI_8},
    {9,5,3,Y(9),-FG,-M_PI_8},
    {10,5,3,Y(10),-FG,-M_PI_8},
    {11,5,3,Y(11),-FG,-M_PI_8},
    {13,5,3,Y(13),-FG,-M_PI_8},
    {14,5,3,Y(14),-FG,-M_PI_8},
    {15,5,3,Y(15),-FG,-M_PI_8},
    {17,5,3,Y(17),-FG,-M_PI_8},
    {18,5,3,Y(18),-FG,-M_PI_8},
    {19,5,3,Y(19),-FG,-M_PI_8},
    {21,5,3,Y(21),-FG,-M_PI_8},
    {22,5,3,Y(22),-FG,-M_PI_8},
    {23,5,3,Y(23),-FG,-M_PI_8},
    {25,5,3,Y(25),-FG,-M_PI_8},
    {26,5,3,Y(26),-FG,-M_PI_8},
    {27,5,3,Y(27),-FG,-M_PI_8},
    {29,5,3,Y(29),-FG,-M_PI_8},
    {30,5,3,Y(30),-FG,-M_PI_8},
    {31,5,3,Y(31),-FG,-M_PI_8},
    //Sloped banked turn
    {1,2,2,Y(1),G,M_PI_4},
    {2,2,2,Y(2),G,M_PI_4},
    {3,2,2,Y(3),G,M_PI_4},
    {5,2,2,Y(5),G,M_PI_4},
    {6,2,2,Y(6),G,M_PI_4},
    {7,2,2,Y(7),G,M_PI_4},
    {9,2,2,Y(9),G,M_PI_4},
    {10,2,2,Y(10),G,M_PI_4},
    {11,2,2,Y(11),G,M_PI_4},
    {13,2,2,Y(13),G,M_PI_4},
    {14,2,2,Y(14),G,M_PI_4},
    {15,2,2,Y(15),G,M_PI_4},
    {17,2,2,Y(17),G,M_PI_4},
    {18,2,2,Y(18),G,M_PI_4},
    {19,2,2,Y(19),G,M_PI_4},
    {21,2,2,Y(21),G,M_PI_4},
    {22,2,2,Y(22),G,M_PI_4},
    {23,2,2,Y(23),G,M_PI_4},
    {25,2,2,Y(25),G,M_PI_4},
    {26,2,2,Y(26),G,M_PI_4},
    {27,2,2,Y(27),G,M_PI_4},
    {29,2,2,Y(29),G,M_PI_4},
    {30,2,2,Y(30),G,M_PI_4},
    {31,2,2,Y(31),G,M_PI_4},
    {1,2,4,Y(1),G,-M_PI_4},
    {2,2,4,Y(2),G,-M_PI_4},
    {3,2,4,Y(3),G,-M_PI_4},
    {5,2,4,Y(5),G,-M_PI_4},
    {6,2,4,Y(6),G,-M_PI_4},
    {7,2,4,Y(7),G,-M_PI_4},
    {9,2,4,Y(9),G,-M_PI_4},
    {10,2,4,Y(10),G,-M_PI_4},
    {11,2,4,Y(11),G,-M_PI_4},
    {13,2,4,Y(13),G,-M_PI_4},
    {14,2,4,Y(14),G,-M_PI_4},
    {15,2,4,Y(15),G,-M_PI_4},
    {17,2,4,Y(17),G,-M_PI_4},
    {18,2,4,Y(18),G,-M_PI_4},
    {19,2,4,Y(19),G,-M_PI_4},
    {21,2,4,Y(21),G,-M_PI_4},
    {22,2,4,Y(22),G,-M_PI_4},
    {23,2,4,Y(23),G,-M_PI_4},
    {25,2,4,Y(25),G,-M_PI_4},
    {26,2,4,Y(26),G,-M_PI_4},
    {27,2,4,Y(27),G,-M_PI_4},
    {29,2,4,Y(29),G,-M_PI_4},
    {30,2,4,Y(30),G,-M_PI_4},
    {31,2,4,Y(31),G,-M_PI_4},
    {1,6,2,Y(1),-G,M_PI_4},
    {2,6,2,Y(2),-G,M_PI_4},
    {3,6,2,Y(3),-G,M_PI_4},
    {5,6,2,Y(5),-G,M_PI_4},
    {6,6,2,Y(6),-G,M_PI_4},
    {7,6,2,Y(7),-G,M_PI_4},
    {9,6,2,Y(9),-G,M_PI_4},
    {10,6,2,Y(10),-G,M_PI_4},
    {11,6,2,Y(11),-G,M_PI_4},
    {13,6,2,Y(13),-G,M_PI_4},
    {14,6,2,Y(14),-G,M_PI_4},
    {15,6,2,Y(15),-G,M_PI_4},
    {17,6,2,Y(17),-G,M_PI_4},
    {18,6,2,Y(18),-G,M_PI_4},
    {19,6,2,Y(19),-G,M_PI_4},
    {21,6,2,Y(21),-G,M_PI_4},
    {22,6,2,Y(22),-G,M_PI_4},
    {23,6,2,Y(23),-G,M_PI_4},
    {25,6,2,Y(25),-G,M_PI_4},
    {26,6,2,Y(26),-G,M_PI_4},
    {27,6,2,Y(27),-G,M_PI_4},
    {29,6,2,Y(29),-G,M_PI_4},
    {30,6,2,Y(30),-G,M_PI_4},
    {31,6,2,Y(31),-G,M_PI_4},
    {1,6,4,Y(1),-G,-M_PI_4},
    {2,6,4,Y(2),-G,-M_PI_4},
    {3,6,4,Y(3),-G,-M_PI_4},
    {5,6,4,Y(5),-G,-M_PI_4},
    {6,6,4,Y(6),-G,-M_PI_4},
    {7,6,4,Y(7),-G,-M_PI_4},
    {9,6,4,Y(9),-G,-M_PI_4},
    {10,6,4,Y(10),-G,-M_PI_4},
    {11,6,4,Y(11),-G,-M_PI_4},
    {13,6,4,Y(13),-G,-M_PI_4},
    {14,6,4,Y(14),-G,-M_PI_4},
    {15,6,4,Y(15),-G,-M_PI_4},
    {17,6,4,Y(17),-G,-M_PI_4},
    {18,6,4,Y(18),-G,-M_PI_4},
    {19,6,4,Y(19),-G,-M_PI_4},
    {21,6,4,Y(21),-G,-M_PI_4},
    {22,6,4,Y(22),-G,-M_PI_4},
    {23,6,4,Y(23),-G,-M_PI_4},
    {25,6,4,Y(25),-G,-M_PI_4},
    {26,6,4,Y(26),-G,-M_PI_4},
    {27,6,4,Y(27),-G,-M_PI_4},
    {29,6,4,Y(29),-G,-M_PI_4},
    {30,6,4,Y(30),-G,-M_PI_4},
    {31,6,4,Y(31),-G,-M_PI_4},
};

/*
sprite_rotation_t base_sprite_rotations[708]=
    {
    //Flat sprites
    { 0,0,0,Y( 0),0.0,0.0},
    { 1,0,0,Y( 1),0.0,0.0},
    { 2,0,0,Y( 2),0.0,0.0},
    { 3,0,0,Y( 3),0.0,0.0},
    { 4,0,0,Y( 4),0.0,0.0},
    { 5,0,0,Y( 5),0.0,0.0},
    { 6,0,0,Y( 6),0.0,0.0},
    { 7,0,0,Y( 7),0.0,0.0},
    { 8,0,0,Y( 8),0.0,0.0},
    { 9,0,0,Y( 9),0.0,0.0},
    {10,0,0,Y(10),0.0,0.0},
    {11,0,0,Y(11),0.0,0.0},
    {12,0,0,Y(12),0.0,0.0},
    {13,0,0,Y(13),0.0,0.0},
    {14,0,0,Y(14),0.0,0.0},
    {15,0,0,Y(15),0.0,0.0},
    {16,0,0,Y(16),0.0,0.0},
    {17,0,0,Y(17),0.0,0.0},
    {18,0,0,Y(18),0.0,0.0},
    {19,0,0,Y(19),0.0,0.0},
    {20,0,0,Y(20),0.0,0.0},
    {21,0,0,Y(21),0.0,0.0},
    {22,0,0,Y(22),0.0,0.0},
    {23,0,0,Y(23),0.0,0.0},
    {24,0,0,Y(24),0.0,0.0},
    {25,0,0,Y(25),0.0,0.0},
    {26,0,0,Y(26),0.0,0.0},
    {27,0,0,Y(27),0.0,0.0},
    {28,0,0,Y(28),0.0,0.0},
    {29,0,0,Y(29),0.0,0.0},
    {30,0,0,Y(30),0.0,0.0},
    {31,0,0,Y(31),0.0,0.0},
    //Gentle slope sprites
    { 0,1,0,Y( 0),FG,0.0},
    { 8,1,0,Y( 8),FG,0.0},
    {16,1,0,Y(16),FG,0.0},
    {24,1,0,Y(24),FG,0.0},
    { 0,5,0,Y( 0),-FG,0.0},
    { 8,5,0,Y( 8),-FG,0.0},
    {16,5,0,Y(16),-FG,0.0},
    {24,5,0,Y(24),-FG,0.0},
    { 0,2,0,Y( 0),G,0.0},
    { 1,2,0,Y( 1),G,0.0},
    { 2,2,0,Y( 2),G,0.0},
    { 3,2,0,Y( 3),G,0.0},
    { 4,2,0,Y( 4),G,0.0},
    { 5,2,0,Y( 5),G,0.0},
    { 6,2,0,Y( 6),G,0.0},
    { 7,2,0,Y( 7),G,0.0},
    { 8,2,0,Y( 8),G,0.0},
    { 9,2,0,Y( 9),G,0.0},
    {10,2,0,Y(10),G,0.0},
    {11,2,0,Y(11),G,0.0},
    {12,2,0,Y(12),G,0.0},
    {13,2,0,Y(13),G,0.0},
    {14,2,0,Y(14),G,0.0},
    {15,2,0,Y(15),G,0.0},
    {16,2,0,Y(16),G,0.0},
    {17,2,0,Y(17),G,0.0},
    {18,2,0,Y(18),G,0.0},
    {19,2,0,Y(19),G,0.0},
    {20,2,0,Y(20),G,0.0},
    {21,2,0,Y(21),G,0.0},
    {22,2,0,Y(22),G,0.0},
    {23,2,0,Y(23),G,0.0},
    {24,2,0,Y(24),G,0.0},
    {25,2,0,Y(25),G,0.0},
    {26,2,0,Y(26),G,0.0},
    {27,2,0,Y(27),G,0.0},
    {28,2,0,Y(28),G,0.0},
    {29,2,0,Y(29),G,0.0},
    {30,2,0,Y(30),G,0.0},
    {31,2,0,Y(31),G,0.0},
    { 0,6,0,Y( 0),-G,0.0},
    { 1,6,0,Y( 1),-G,0.0},
    { 2,6,0,Y( 2),-G,0.0},
    { 3,6,0,Y( 3),-G,0.0},
    { 4,6,0,Y( 4),-G,0.0},
    { 5,6,0,Y( 5),-G,0.0},
    { 6,6,0,Y( 6),-G,0.0},
    { 7,6,0,Y( 7),-G,0.0},
    { 8,6,0,Y( 8),-G,0.0},
    { 9,6,0,Y( 9),-G,0.0},
    {10,6,0,Y(10),-G,0.0},
    {11,6,0,Y(11),-G,0.0},
    {12,6,0,Y(12),-G,0.0},
    {13,6,0,Y(13),-G,0.0},
    {14,6,0,Y(14),-G,0.0},
    {15,6,0,Y(15),-G,0.0},
    {16,6,0,Y(16),-G,0.0},
    {17,6,0,Y(17),-G,0.0},
    {18,6,0,Y(18),-G,0.0},
    {19,6,0,Y(19),-G,0.0},
    {20,6,0,Y(20),-G,0.0},
    {21,6,0,Y(21),-G,0.0},
    {22,6,0,Y(22),-G,0.0},
    {23,6,0,Y(23),-G,0.0},
    {24,6,0,Y(24),-G,0.0},
    {25,6,0,Y(25),-G,0.0},
    {26,6,0,Y(26),-G,0.0},
    {27,6,0,Y(27),-G,0.0},
    {28,6,0,Y(28),-G,0.0},
    {29,6,0,Y(29),-G,0.0},
    {30,6,0,Y(30),-G,0.0},
    {31,6,0,Y(31),-G,0.0},
    //Steep slope sprites
    { 0,3,0,Y( 0),GS,0.0},
    { 4,3,0,Y( 4),GS,0.0},
    { 8,3,0,Y( 8),GS,0.0},
    {12,3,0,Y(12),GS,0.0},
    {16,3,0,Y(16),GS,0.0},
    {20,3,0,Y(20),GS,0.0},
    {24,3,0,Y(24),GS,0.0},
    {28,3,0,Y(28),GS,0.0},
    { 0,7,0,Y( 0),-GS,0.0},
    { 4,7,0,Y( 4),-GS,0.0},
    { 8,7,0,Y( 8),-GS,0.0},
    {12,7,0,Y(12),-GS,0.0},
    {16,7,0,Y(16),-GS,0.0},
    {20,7,0,Y(20),-GS,0.0},
    {24,7,0,Y(24),-GS,0.0},
    {28,7,0,Y(28),-GS,0.0},
    { 0,4,0,Y( 0),S,0.0},
    { 1,4,0,Y( 1),S,0.0},
    { 2,4,0,Y( 2),S,0.0},
    { 3,4,0,Y( 3),S,0.0},
    { 4,4,0,Y( 4),S,0.0},
    { 5,4,0,Y( 5),S,0.0},
    { 6,4,0,Y( 6),S,0.0},
    { 7,4,0,Y( 7),S,0.0},
    { 8,4,0,Y( 8),S,0.0},
    { 9,4,0,Y( 9),S,0.0},
    {10,4,0,Y(10),S,0.0},
    {11,4,0,Y(11),S,0.0},
    {12,4,0,Y(12),S,0.0},
    {13,4,0,Y(13),S,0.0},
    {14,4,0,Y(14),S,0.0},
    {15,4,0,Y(15),S,0.0},
    {16,4,0,Y(16),S,0.0},
    {17,4,0,Y(17),S,0.0},
    {18,4,0,Y(18),S,0.0},
    {19,4,0,Y(19),S,0.0},
    {20,4,0,Y(20),S,0.0},
    {21,4,0,Y(21),S,0.0},
    {22,4,0,Y(22),S,0.0},
    {23,4,0,Y(23),S,0.0},
    {24,4,0,Y(24),S,0.0},
    {25,4,0,Y(25),S,0.0},
    {26,4,0,Y(26),S,0.0},
    {27,4,0,Y(27),S,0.0},
    {28,4,0,Y(28),S,0.0},
    {29,4,0,Y(29),S,0.0},
    {30,4,0,Y(30),S,0.0},
    {31,4,0,Y(31),S,0.0},
    { 0,8,0,Y( 0),-S,0.0},
    { 1,8,0,Y( 1),-S,0.0},
    { 2,8,0,Y( 2),-S,0.0},
    { 3,8,0,Y( 3),-S,0.0},
    { 4,8,0,Y( 4),-S,0.0},
    { 5,8,0,Y( 5),-S,0.0},
    { 6,8,0,Y( 6),-S,0.0},
    { 7,8,0,Y( 7),-S,0.0},
    { 8,8,0,Y( 8),-S,0.0},
    { 9,8,0,Y( 9),-S,0.0},
    {10,8,0,Y(10),-S,0.0},
    {11,8,0,Y(11),-S,0.0},
    {12,8,0,Y(12),-S,0.0},
    {13,8,0,Y(13),-S,0.0},
    {14,8,0,Y(14),-S,0.0},
    {15,8,0,Y(15),-S,0.0},
    {16,8,0,Y(16),-S,0.0},
    {17,8,0,Y(17),-S,0.0},
    {18,8,0,Y(18),-S,0.0},
    {19,8,0,Y(19),-S,0.0},
    {20,8,0,Y(20),-S,0.0},
    {21,8,0,Y(21),-S,0.0},
    {22,8,0,Y(22),-S,0.0},
    {23,8,0,Y(23),-S,0.0},
    {24,8,0,Y(24),-S,0.0},
    {25,8,0,Y(25),-S,0.0},
    {26,8,0,Y(26),-S,0.0},
    {27,8,0,Y(27),-S,0.0},
    {28,8,0,Y(28),-S,0.0},
    {29,8,0,Y(29),-S,0.0},
    {30,8,0,Y(30),-S,0.0},
    {31,8,0,Y(31),-S,0.0},
    //Vertical slope sprites
    { 0,9,0,Y( 0),SV,0.0},
    { 8,9,0,Y( 8),SV,0.0},
    {16,9,0,Y(16),SV,0.0},
    {24,9,0,Y(24),SV,0.0},
    { 0,17,0,Y( 0),-SV,0.0},
    { 8,17,0,Y( 8),-SV,0.0},
    {16,17,0,Y(16),-SV,0.0},
    {24,17,0,Y(24),-SV,0.0},
    { 0,10,0,Y( 0),V,0.0},
    { 1,10,0,Y( 1),V,0.0},
    { 2,10,0,Y( 2),V,0.0},
    { 3,10,0,Y( 3),V,0.0},
    { 4,10,0,Y( 4),V,0.0},
    { 5,10,0,Y( 5),V,0.0},
    { 6,10,0,Y( 6),V,0.0},
    { 7,10,0,Y( 7),V,0.0},
    { 8,10,0,Y( 8),V,0.0},
    { 9,10,0,Y( 9),V,0.0},
    {10,10,0,Y(10),V,0.0},
    {11,10,0,Y(11),V,0.0},
    {12,10,0,Y(12),V,0.0},
    {13,10,0,Y(13),V,0.0},
    {14,10,0,Y(14),V,0.0},
    {15,10,0,Y(15),V,0.0},
    {16,10,0,Y(16),V,0.0},
    {17,10,0,Y(17),V,0.0},
    {18,10,0,Y(18),V,0.0},
    {19,10,0,Y(19),V,0.0},
    {20,10,0,Y(20),V,0.0},
    {21,10,0,Y(21),V,0.0},
    {22,10,0,Y(22),V,0.0},
    {23,10,0,Y(23),V,0.0},
    {24,10,0,Y(24),V,0.0},
    {25,10,0,Y(25),V,0.0},
    {26,10,0,Y(26),V,0.0},
    {27,10,0,Y(27),V,0.0},
    {28,10,0,Y(28),V,0.0},
    {29,10,0,Y(29),V,0.0},
    {30,10,0,Y(30),V,0.0},
    {31,10,0,Y(31),V,0.0},
    { 0,18,0,Y( 0),-V,0.0},
    { 1,18,0,Y( 1),-V,0.0},
    { 2,18,0,Y( 2),-V,0.0},
    { 3,18,0,Y( 3),-V,0.0},
    { 4,18,0,Y( 4),-V,0.0},
    { 5,18,0,Y( 5),-V,0.0},
    { 6,18,0,Y( 6),-V,0.0},
    { 7,18,0,Y( 7),-V,0.0},
    { 8,18,0,Y( 8),-V,0.0},
    { 9,18,0,Y( 9),-V,0.0},
    {10,18,0,Y(10),-V,0.0},
    {11,18,0,Y(11),-V,0.0},
    {12,18,0,Y(12),-V,0.0},
    {13,18,0,Y(13),-V,0.0},
    {14,18,0,Y(14),-V,0.0},
    {15,18,0,Y(15),-V,0.0},
    {16,18,0,Y(16),-V,0.0},
    {17,18,0,Y(17),-V,0.0},
    {18,18,0,Y(18),-V,0.0},
    {19,18,0,Y(19),-V,0.0},
    {20,18,0,Y(20),-V,0.0},
    {21,18,0,Y(21),-V,0.0},
    {22,18,0,Y(22),-V,0.0},
    {23,18,0,Y(23),-V,0.0},
    {24,18,0,Y(24),-V,0.0},
    {25,18,0,Y(25),-V,0.0},
    {26,18,0,Y(26),-V,0.0},
    {27,18,0,Y(27),-V,0.0},
    {28,18,0,Y(28),-V,0.0},
    {29,18,0,Y(29),-V,0.0},
    {30,18,0,Y(30),-V,0.0},
    {31,18,0,Y(31),-V,0.0},
    { 0,11,0,Y( 0),V+1*M_PI_12,0.0},
    { 8,11,0,Y( 8),V+1*M_PI_12,0.0},
    {16,11,0,Y(16),V+1*M_PI_12,0.0},
    {24,11,0,Y(24),V+1*M_PI_12,0.0},
    { 0,12,0,Y( 0),V+2*M_PI_12,0.0},
    { 8,12,0,Y( 8),V+2*M_PI_12,0.0},
    {16,12,0,Y(16),V+2*M_PI_12,0.0},
    {24,12,0,Y(24),V+2*M_PI_12,0.0},
    { 0,13,0,Y( 0),V+3*M_PI_12,0.0},
    { 8,13,0,Y( 8),V+3*M_PI_12,0.0},
    {16,13,0,Y(16),V+3*M_PI_12,0.0},
    {24,13,0,Y(24),V+3*M_PI_12,0.0},
    { 0,14,0,Y( 0),V+4*M_PI_12,0.0},
    { 8,14,0,Y( 8),V+4*M_PI_12,0.0},
    {16,14,0,Y(16),V+4*M_PI_12,0.0},
    {24,14,0,Y(24),V+4*M_PI_12,0.0},
    { 0,15,0,Y( 0),V+5*M_PI_12,0.0},
    { 8,15,0,Y( 8),V+5*M_PI_12,0.0},
    {16,15,0,Y(16),V+5*M_PI_12,0.0},
    {24,15,0,Y(24),V+5*M_PI_12,0.0},
    { 0,16,0,Y( 0),V+6*M_PI_12,0.0},
    { 8,16,0,Y( 8),V+6*M_PI_12,0.0},
    {16,16,0,Y(16),V+6*M_PI_12,0.0},
    {24,16,0,Y(24),V+6*M_PI_12,0.0},
    { 0,19,0,Y( 0),-V-1*M_PI_12,0.0},
    { 8,19,0,Y( 8),-V-1*M_PI_12,0.0},
    {16,19,0,Y(16),-V-1*M_PI_12,0.0},
    {24,19,0,Y(24),-V-1*M_PI_12,0.0},
    { 0,20,0,Y( 0),-V-2*M_PI_12,0.0},
    { 8,20,0,Y( 8),-V-2*M_PI_12,0.0},
    {16,20,0,Y(16),-V-2*M_PI_12,0.0},
    {24,20,0,Y(24),-V-2*M_PI_12,0.0},
    { 0,21,0,Y( 0),-V-3*M_PI_12,0.0},
    { 8,21,0,Y( 8),-V-3*M_PI_12,0.0},
    {16,21,0,Y(16),-V-3*M_PI_12,0.0},
    {24,21,0,Y(24),-V-3*M_PI_12,0.0},
    { 0,22,0,Y( 0),-V-4*M_PI_12,0.0},
    { 8,22,0,Y( 8),-V-4*M_PI_12,0.0},
    {16,22,0,Y(16),-V-4*M_PI_12,0.0},
    {24,22,0,Y(24),-V-4*M_PI_12,0.0},
    { 0,23,0,Y( 0),-V-5*M_PI_12,0.0},
    { 8,23,0,Y( 8),-V-5*M_PI_12,0.0},
    {16,23,0,Y(16),-V-5*M_PI_12,0.0},
    {24,23,0,Y(24),-V-5*M_PI_12,0.0},
    //Diagonal sprites
    {4 ,50,0,Y(4),FGD,0.0},
    {12,50,0,Y(12),FGD,0.0},
    {20,50,0,Y(20),FGD,0.0},
    {28,50,0,Y(28),FGD,0.0},
    {4 ,53,0,Y(4),-FGD,0.0},
    {12,53,0,Y(12),-FGD,0.0},
    {20,53,0,Y(20),-FGD,0.0},
    {28,53,0,Y(28),-FGD,0.0},
    {4 ,51,0,Y(4),GD,0.0},
    {12,51,0,Y(12),GD,0.0},
    {20,51,0,Y(20),GD,0.0},
    {28,51,0,Y(28),GD,0.0},
    {4 ,54,0,Y(4),-GD,0.0},
    {12,54,0,Y(12),-GD,0.0},
    {20,54,0,Y(20),-GD,0.0},
    {28,54,0,Y(28),-GD,0.0},
    {4 ,52,0,Y(4),SD,0.0},
    {12,52,0,Y(12),SD,0.0},
    {20,52,0,Y(20),SD,0.0},
    {28,52,0,Y(28),SD,0.0},
    {4 ,55,0,Y(4),-SD,0.0},
    {12,55,0,Y(12),-SD,0.0},
    {20,55,0,Y(20),-SD,0.0},
    {28,55,0,Y(28),-SD,0.0},
    //Banked turn sprites
    { 0,0,1,Y( 0),0,M_PI_8},
    { 4,0,1,Y( 4),0,M_PI_8},
    { 8,0,1,Y( 8),0,M_PI_8},
    {12,0,1,Y(12),0,M_PI_8},
    {16,0,1,Y(16),0,M_PI_8},
    {20,0,1,Y(20),0,M_PI_8},
    {24,0,1,Y(24),0,M_PI_8},
    {28,0,1,Y(28),0,M_PI_8},
    { 0,0,3,Y( 0),0,-M_PI_8},
    { 4,0,3,Y( 4),0,-M_PI_8},
    { 8,0,3,Y( 8),0,-M_PI_8},
    {12,0,3,Y(12),0,-M_PI_8},
    {16,0,3,Y(16),0,-M_PI_8},
    {20,0,3,Y(20),0,-M_PI_8},
    {24,0,3,Y(24),0,-M_PI_8},
    {28,0,3,Y(28),0,-M_PI_8},
    { 0,0,2,Y( 0),0,M_PI_4},
    { 1,0,2,Y( 1),0,M_PI_4},
    { 2,0,2,Y( 2),0,M_PI_4},
    { 3,0,2,Y( 3),0,M_PI_4},
    { 4,0,2,Y( 4),0,M_PI_4},
    { 5,0,2,Y( 5),0,M_PI_4},
    { 6,0,2,Y( 6),0,M_PI_4},
    { 7,0,2,Y( 7),0,M_PI_4},
    { 8,0,2,Y( 8),0,M_PI_4},
    { 9,0,2,Y( 9),0,M_PI_4},
    {10,0,2,Y(10),0,M_PI_4},
    {11,0,2,Y(11),0,M_PI_4},
    {12,0,2,Y(12),0,M_PI_4},
    {13,0,2,Y(13),0,M_PI_4},
    {14,0,2,Y(14),0,M_PI_4},
    {15,0,2,Y(15),0,M_PI_4},
    {16,0,2,Y(16),0,M_PI_4},
    {17,0,2,Y(17),0,M_PI_4},
    {18,0,2,Y(18),0,M_PI_4},
    {19,0,2,Y(19),0,M_PI_4},
    {20,0,2,Y(20),0,M_PI_4},
    {21,0,2,Y(21),0,M_PI_4},
    {22,0,2,Y(22),0,M_PI_4},
    {23,0,2,Y(23),0,M_PI_4},
    {24,0,2,Y(24),0,M_PI_4},
    {25,0,2,Y(25),0,M_PI_4},
    {26,0,2,Y(26),0,M_PI_4},
    {27,0,2,Y(27),0,M_PI_4},
    {28,0,2,Y(28),0,M_PI_4},
    {29,0,2,Y(29),0,M_PI_4},
    {30,0,2,Y(30),0,M_PI_4},
    {31,0,2,Y(31),0,M_PI_4},
    { 0,0,4,Y( 0),0,-M_PI_4},
    { 1,0,4,Y( 1),0,-M_PI_4},
    { 2,0,4,Y( 2),0,-M_PI_4},
    { 3,0,4,Y( 3),0,-M_PI_4},
    { 4,0,4,Y( 4),0,-M_PI_4},
    { 5,0,4,Y( 5),0,-M_PI_4},
    { 6,0,4,Y( 6),0,-M_PI_4},
    { 7,0,4,Y( 7),0,-M_PI_4},
    { 8,0,4,Y( 8),0,-M_PI_4},
    { 9,0,4,Y( 9),0,-M_PI_4},
    {10,0,4,Y(10),0,-M_PI_4},
    {11,0,4,Y(11),0,-M_PI_4},
    {12,0,4,Y(12),0,-M_PI_4},
    {13,0,4,Y(13),0,-M_PI_4},
    {14,0,4,Y(14),0,-M_PI_4},
    {15,0,4,Y(15),0,-M_PI_4},
    {16,0,4,Y(16),0,-M_PI_4},
    {17,0,4,Y(17),0,-M_PI_4},
    {18,0,4,Y(18),0,-M_PI_4},
    {19,0,4,Y(19),0,-M_PI_4},
    {20,0,4,Y(20),0,-M_PI_4},
    {21,0,4,Y(21),0,-M_PI_4},
    {22,0,4,Y(22),0,-M_PI_4},
    {23,0,4,Y(23),0,-M_PI_4},
    {24,0,4,Y(24),0,-M_PI_4},
    {25,0,4,Y(25),0,-M_PI_4},
    {26,0,4,Y(26),0,-M_PI_4},
    {27,0,4,Y(27),0,-M_PI_4},
    {28,0,4,Y(28),0,-M_PI_4},
    {29,0,4,Y(29),0,-M_PI_4},
    {30,0,4,Y(30),0,-M_PI_4},
    {31,0,4,Y(31),0,-M_PI_4},
    //Slope bank transition
    { 0,1,1,Y( 0),FG,M_PI_8},
    { 1,1,1,Y( 1),FG,M_PI_8},
    { 2,1,1,Y( 2),FG,M_PI_8},
    { 3,1,1,Y( 3),FG,M_PI_8},
    { 4,1,1,Y( 4),FG,M_PI_8},
    { 5,1,1,Y( 5),FG,M_PI_8},
    { 6,1,1,Y( 6),FG,M_PI_8},
    { 7,1,1,Y( 7),FG,M_PI_8},
    { 8,1,1,Y( 8),FG,M_PI_8},
    { 9,1,1,Y( 9),FG,M_PI_8},
    {10,1,1,Y(10),FG,M_PI_8},
    {11,1,1,Y(11),FG,M_PI_8},
    {12,1,1,Y(12),FG,M_PI_8},
    {13,1,1,Y(13),FG,M_PI_8},
    {14,1,1,Y(14),FG,M_PI_8},
    {15,1,1,Y(15),FG,M_PI_8},
    {16,1,1,Y(16),FG,M_PI_8},
    {17,1,1,Y(17),FG,M_PI_8},
    {18,1,1,Y(18),FG,M_PI_8},
    {19,1,1,Y(19),FG,M_PI_8},
    {20,1,1,Y(20),FG,M_PI_8},
    {21,1,1,Y(21),FG,M_PI_8},
    {22,1,1,Y(22),FG,M_PI_8},
    {23,1,1,Y(23),FG,M_PI_8},
    {24,1,1,Y(24),FG,M_PI_8},
    {25,1,1,Y(25),FG,M_PI_8},
    {26,1,1,Y(26),FG,M_PI_8},
    {27,1,1,Y(27),FG,M_PI_8},
    {28,1,1,Y(28),FG,M_PI_8},
    {29,1,1,Y(29),FG,M_PI_8},
    {30,1,1,Y(30),FG,M_PI_8},
    {31,1,1,Y(31),FG,M_PI_8},
    { 0,1,3,Y( 0),FG,-M_PI_8},
    { 1,1,3,Y( 1),FG,-M_PI_8},
    { 2,1,3,Y( 2),FG,-M_PI_8},
    { 3,1,3,Y( 3),FG,-M_PI_8},
    { 4,1,3,Y( 4),FG,-M_PI_8},
    { 5,1,3,Y( 5),FG,-M_PI_8},
    { 6,1,3,Y( 6),FG,-M_PI_8},
    { 7,1,3,Y( 7),FG,-M_PI_8},
    { 8,1,3,Y( 8),FG,-M_PI_8},
    { 9,1,3,Y( 9),FG,-M_PI_8},
    {10,1,3,Y(10),FG,-M_PI_8},
    {11,1,3,Y(11),FG,-M_PI_8},
    {12,1,3,Y(12),FG,-M_PI_8},
    {13,1,3,Y(13),FG,-M_PI_8},
    {14,1,3,Y(14),FG,-M_PI_8},
    {15,1,3,Y(15),FG,-M_PI_8},
    {16,1,3,Y(16),FG,-M_PI_8},
    {17,1,3,Y(17),FG,-M_PI_8},
    {18,1,3,Y(18),FG,-M_PI_8},
    {19,1,3,Y(19),FG,-M_PI_8},
    {20,1,3,Y(20),FG,-M_PI_8},
    {21,1,3,Y(21),FG,-M_PI_8},
    {22,1,3,Y(22),FG,-M_PI_8},
    {23,1,3,Y(23),FG,-M_PI_8},
    {24,1,3,Y(24),FG,-M_PI_8},
    {25,1,3,Y(25),FG,-M_PI_8},
    {26,1,3,Y(26),FG,-M_PI_8},
    {27,1,3,Y(27),FG,-M_PI_8},
    {28,1,3,Y(28),FG,-M_PI_8},
    {29,1,3,Y(29),FG,-M_PI_8},
    {30,1,3,Y(30),FG,-M_PI_8},
    {31,1,3,Y(31),FG,-M_PI_8},
    { 0,5,1,Y( 0),-FG,M_PI_8},
    { 1,5,1,Y( 1),-FG,M_PI_8},
    { 2,5,1,Y( 2),-FG,M_PI_8},
    { 3,5,1,Y( 3),-FG,M_PI_8},
    { 4,5,1,Y( 4),-FG,M_PI_8},
    { 5,5,1,Y( 5),-FG,M_PI_8},
    { 6,5,1,Y( 6),-FG,M_PI_8},
    { 7,5,1,Y( 7),-FG,M_PI_8},
    { 8,5,1,Y( 8),-FG,M_PI_8},
    { 9,5,1,Y( 9),-FG,M_PI_8},
    {10,5,1,Y(10),-FG,M_PI_8},
    {11,5,1,Y(11),-FG,M_PI_8},
    {12,5,1,Y(12),-FG,M_PI_8},
    {13,5,1,Y(13),-FG,M_PI_8},
    {14,5,1,Y(14),-FG,M_PI_8},
    {15,5,1,Y(15),-FG,M_PI_8},
    {16,5,1,Y(16),-FG,M_PI_8},
    {17,5,1,Y(17),-FG,M_PI_8},
    {18,5,1,Y(18),-FG,M_PI_8},
    {19,5,1,Y(19),-FG,M_PI_8},
    {20,5,1,Y(20),-FG,M_PI_8},
    {21,5,1,Y(21),-FG,M_PI_8},
    {22,5,1,Y(22),-FG,M_PI_8},
    {23,5,1,Y(23),-FG,M_PI_8},
    {24,5,1,Y(24),-FG,M_PI_8},
    {25,5,1,Y(25),-FG,M_PI_8},
    {26,5,1,Y(26),-FG,M_PI_8},
    {27,5,1,Y(27),-FG,M_PI_8},
    {28,5,1,Y(28),-FG,M_PI_8},
    {29,5,1,Y(29),-FG,M_PI_8},
    {30,5,1,Y(30),-FG,M_PI_8},
    {31,5,1,Y(31),-FG,M_PI_8},
    { 0,5,3,Y( 0),-FG,-M_PI_8},
    { 1,5,3,Y( 1),-FG,-M_PI_8},
    { 2,5,3,Y( 2),-FG,-M_PI_8},
    { 3,5,3,Y( 3),-FG,-M_PI_8},
    { 4,5,3,Y( 4),-FG,-M_PI_8},
    { 5,5,3,Y( 5),-FG,-M_PI_8},
    { 6,5,3,Y( 6),-FG,-M_PI_8},
    { 7,5,3,Y( 7),-FG,-M_PI_8},
    { 8,5,3,Y( 8),-FG,-M_PI_8},
    { 9,5,3,Y( 9),-FG,-M_PI_8},
    {10,5,3,Y(10),-FG,-M_PI_8},
    {11,5,3,Y(11),-FG,-M_PI_8},
    {12,5,3,Y(12),-FG,-M_PI_8},
    {13,5,3,Y(13),-FG,-M_PI_8},
    {14,5,3,Y(14),-FG,-M_PI_8},
    {15,5,3,Y(15),-FG,-M_PI_8},
    {16,5,3,Y(16),-FG,-M_PI_8},
    {17,5,3,Y(17),-FG,-M_PI_8},
    {18,5,3,Y(18),-FG,-M_PI_8},
    {19,5,3,Y(19),-FG,-M_PI_8},
    {20,5,3,Y(20),-FG,-M_PI_8},
    {21,5,3,Y(21),-FG,-M_PI_8},
    {22,5,3,Y(22),-FG,-M_PI_8},
    {23,5,3,Y(23),-FG,-M_PI_8},
    {24,5,3,Y(24),-FG,-M_PI_8},
    {25,5,3,Y(25),-FG,-M_PI_8},
    {26,5,3,Y(26),-FG,-M_PI_8},
    {27,5,3,Y(27),-FG,-M_PI_8},
    {28,5,3,Y(28),-FG,-M_PI_8},
    {29,5,3,Y(29),-FG,-M_PI_8},
    {30,5,3,Y(30),-FG,-M_PI_8},
    {31,5,3,Y(31),-FG,-M_PI_8},
    //Diagonal bank transition
    {4 ,50,1,Y(4),FGD,M_PI_8},
    {12,50,1,Y(12),FGD,M_PI_8},
    {20,50,1,Y(20),FGD,M_PI_8},
    {28,50,1,Y(28),FGD,M_PI_8},
    {4 ,50,3,Y(4),FGD,-M_PI_8},
    {12,50,3,Y(12),FGD,-M_PI_8},
    {20,50,3,Y(20),FGD,-M_PI_8},
    {28,50,3,Y(28),FGD,-M_PI_8},
    {4 ,53,1,Y(4),-FGD,M_PI_8},
    {12,53,1,Y(12),-FGD,M_PI_8},
    {20,53,1,Y(20),-FGD,M_PI_8},
    {28,53,1,Y(28),-FGD,M_PI_8},
    {4 ,53,3,Y(4),-FGD,-M_PI_8},
    {12,53,3,Y(12),-FGD,-M_PI_8},
    {20,53,3,Y(20),-FGD,-M_PI_8},
    {28,53,3,Y(28),-FGD,-M_PI_8},
    //Sloped bank transition
    { 0,2,1,Y( 0),G,M_PI_8},
    { 8,2,1,Y( 8),G,M_PI_8},
    {16,2,1,Y(16),G,M_PI_8},
    {24,2,1,Y(24),G,M_PI_8},
    { 0,2,3,Y( 0),G,-M_PI_8},
    { 8,2,3,Y( 8),G,-M_PI_8},
    {16,2,3,Y(16),G,-M_PI_8},
    {24,2,3,Y(24),G,-M_PI_8},
    { 0,6,1,Y( 0),-G,M_PI_8},
    { 8,6,1,Y( 8),-G,M_PI_8},
    {16,6,1,Y(16),-G,M_PI_8},
    {24,6,1,Y(24),-G,M_PI_8},
    { 0,6,3,Y( 0),-G,-M_PI_8},
    { 8,6,3,Y( 8),-G,-M_PI_8},
    {16,6,3,Y(16),-G,-M_PI_8},
    {24,6,3,Y(24),-G,-M_PI_8},
    //Sloped banked turn
    { 0,2,2,Y( 0),G,M_PI_4},
    { 1,2,2,Y( 1),G,M_PI_4},
    { 2,2,2,Y( 2),G,M_PI_4},
    { 3,2,2,Y( 3),G,M_PI_4},
    { 4,2,2,Y( 4),G,M_PI_4},
    { 5,2,2,Y( 5),G,M_PI_4},
    { 6,2,2,Y( 6),G,M_PI_4},
    { 7,2,2,Y( 7),G,M_PI_4},
    { 8,2,2,Y( 8),G,M_PI_4},
    { 9,2,2,Y( 9),G,M_PI_4},
    {10,2,2,Y(10),G,M_PI_4},
    {11,2,2,Y(11),G,M_PI_4},
    {12,2,2,Y(12),G,M_PI_4},
    {13,2,2,Y(13),G,M_PI_4},
    {14,2,2,Y(14),G,M_PI_4},
    {15,2,2,Y(15),G,M_PI_4},
    {16,2,2,Y(16),G,M_PI_4},
    {17,2,2,Y(17),G,M_PI_4},
    {18,2,2,Y(18),G,M_PI_4},
    {19,2,2,Y(19),G,M_PI_4},
    {20,2,2,Y(20),G,M_PI_4},
    {21,2,2,Y(21),G,M_PI_4},
    {22,2,2,Y(22),G,M_PI_4},
    {23,2,2,Y(23),G,M_PI_4},
    {24,2,2,Y(24),G,M_PI_4},
    {25,2,2,Y(25),G,M_PI_4},
    {26,2,2,Y(26),G,M_PI_4},
    {27,2,2,Y(27),G,M_PI_4},
    {28,2,2,Y(28),G,M_PI_4},
    {29,2,2,Y(29),G,M_PI_4},
    {30,2,2,Y(30),G,M_PI_4},
    {31,2,2,Y(31),G,M_PI_4},
    { 0,2,4,Y( 0),G,-M_PI_4},
    { 1,2,4,Y( 1),G,-M_PI_4},
    { 2,2,4,Y( 2),G,-M_PI_4},
    { 3,2,4,Y( 3),G,-M_PI_4},
    { 4,2,4,Y( 4),G,-M_PI_4},
    { 5,2,4,Y( 5),G,-M_PI_4},
    { 6,2,4,Y( 6),G,-M_PI_4},
    { 7,2,4,Y( 7),G,-M_PI_4},
    { 8,2,4,Y( 8),G,-M_PI_4},
    { 9,2,4,Y( 9),G,-M_PI_4},
    {10,2,4,Y(10),G,-M_PI_4},
    {11,2,4,Y(11),G,-M_PI_4},
    {12,2,4,Y(12),G,-M_PI_4},
    {13,2,4,Y(13),G,-M_PI_4},
    {14,2,4,Y(14),G,-M_PI_4},
    {15,2,4,Y(15),G,-M_PI_4},
    {16,2,4,Y(16),G,-M_PI_4},
    {17,2,4,Y(17),G,-M_PI_4},
    {18,2,4,Y(18),G,-M_PI_4},
    {19,2,4,Y(19),G,-M_PI_4},
    {20,2,4,Y(20),G,-M_PI_4},
    {21,2,4,Y(21),G,-M_PI_4},
    {22,2,4,Y(22),G,-M_PI_4},
    {23,2,4,Y(23),G,-M_PI_4},
    {24,2,4,Y(24),G,-M_PI_4},
    {25,2,4,Y(25),G,-M_PI_4},
    {26,2,4,Y(26),G,-M_PI_4},
    {27,2,4,Y(27),G,-M_PI_4},
    {28,2,4,Y(28),G,-M_PI_4},
    {29,2,4,Y(29),G,-M_PI_4},
    {30,2,4,Y(30),G,-M_PI_4},
    {31,2,4,Y(31),G,-M_PI_4},
    { 0,6,2,Y( 0),-G,M_PI_4},
    { 1,6,2,Y( 1),-G,M_PI_4},
    { 2,6,2,Y( 2),-G,M_PI_4},
    { 3,6,2,Y( 3),-G,M_PI_4},
    { 4,6,2,Y( 4),-G,M_PI_4},
    { 5,6,2,Y( 5),-G,M_PI_4},
    { 6,6,2,Y( 6),-G,M_PI_4},
    { 7,6,2,Y( 7),-G,M_PI_4},
    { 8,6,2,Y( 8),-G,M_PI_4},
    { 9,6,2,Y( 9),-G,M_PI_4},
    {10,6,2,Y(10),-G,M_PI_4},
    {11,6,2,Y(11),-G,M_PI_4},
    {12,6,2,Y(12),-G,M_PI_4},
    {13,6,2,Y(13),-G,M_PI_4},
    {14,6,2,Y(14),-G,M_PI_4},
    {15,6,2,Y(15),-G,M_PI_4},
    {16,6,2,Y(16),-G,M_PI_4},
    {17,6,2,Y(17),-G,M_PI_4},
    {18,6,2,Y(18),-G,M_PI_4},
    {19,6,2,Y(19),-G,M_PI_4},
    {20,6,2,Y(20),-G,M_PI_4},
    {21,6,2,Y(21),-G,M_PI_4},
    {22,6,2,Y(22),-G,M_PI_4},
    {23,6,2,Y(23),-G,M_PI_4},
    {24,6,2,Y(24),-G,M_PI_4},
    {25,6,2,Y(25),-G,M_PI_4},
    {26,6,2,Y(26),-G,M_PI_4},
    {27,6,2,Y(27),-G,M_PI_4},
    {28,6,2,Y(28),-G,M_PI_4},
    {29,6,2,Y(29),-G,M_PI_4},
    {30,6,2,Y(30),-G,M_PI_4},
    {31,6,2,Y(31),-G,M_PI_4},
    { 0,6,4,Y( 0),-G,-M_PI_4},
    { 1,6,4,Y( 1),-G,-M_PI_4},
    { 2,6,4,Y( 2),-G,-M_PI_4},
    { 3,6,4,Y( 3),-G,-M_PI_4},
    { 4,6,4,Y( 4),-G,-M_PI_4},
    { 5,6,4,Y( 5),-G,-M_PI_4},
    { 6,6,4,Y( 6),-G,-M_PI_4},
    { 7,6,4,Y( 7),-G,-M_PI_4},
    { 8,6,4,Y( 8),-G,-M_PI_4},
    { 9,6,4,Y( 9),-G,-M_PI_4},
    {10,6,4,Y(10),-G,-M_PI_4},
    {11,6,4,Y(11),-G,-M_PI_4},
    {12,6,4,Y(12),-G,-M_PI_4},
    {13,6,4,Y(13),-G,-M_PI_4},
    {14,6,4,Y(14),-G,-M_PI_4},
    {15,6,4,Y(15),-G,-M_PI_4},
    {16,6,4,Y(16),-G,-M_PI_4},
    {17,6,4,Y(17),-G,-M_PI_4},
    {18,6,4,Y(18),-G,-M_PI_4},
    {19,6,4,Y(19),-G,-M_PI_4},
    {20,6,4,Y(20),-G,-M_PI_4},
    {21,6,4,Y(21),-G,-M_PI_4},
    {22,6,4,Y(22),-G,-M_PI_4},
    {23,6,4,Y(23),-G,-M_PI_4},
    {24,6,4,Y(24),-G,-M_PI_4},
    {25,6,4,Y(25),-G,-M_PI_4},
    {26,6,4,Y(26),-G,-M_PI_4},
    {27,6,4,Y(27),-G,-M_PI_4},
    {28,6,4,Y(28),-G,-M_PI_4},
    {29,6,4,Y(29),-G,-M_PI_4},
    {30,6,4,Y(30),-G,-M_PI_4},
    {31,6,4,Y(31),-G,-M_PI_4},
    //Banked slope transition
    { 0,1,2,Y( 0),FG,M_PI_4},
    { 8,1,2,Y( 8),FG,M_PI_4},
    {16,1,2,Y(16),FG,M_PI_4},
    {24,1,2,Y(24),FG,M_PI_4},
    { 0,1,4,Y( 0),FG,-M_PI_4},
    { 8,1,4,Y( 8),FG,-M_PI_4},
    {16,1,4,Y(16),FG,-M_PI_4},
    {24,1,4,Y(24),FG,-M_PI_4},
    { 0,5,2,Y( 0),-FG,M_PI_4},
    { 8,5,2,Y( 8),-FG,M_PI_4},
    {16,5,2,Y(16),-FG,M_PI_4},
    {24,5,2,Y(24),-FG,M_PI_4},
    { 0,5,4,Y( 0),-FG,-M_PI_4},
    { 8,5,4,Y( 8),-FG,-M_PI_4},
    {16,5,4,Y(16),-FG,-M_PI_4},
    {24,5,4,Y(24),-FG,-M_PI_4}
};*/

sprite_rotation_t inline_twist_sprite_rotations[40]={
    //Inline twist sprites
    {0,0,5,Y(0),0,3*M_PI_8},    {8,0,5,Y(8),0,3*M_PI_8},    {16,0,5,Y(16),0,3*M_PI_8},  {24,0,5,Y(24),0,3*M_PI_8},  {0,0,10,Y(0),0,-3*M_PI_8}, {8,0,10,Y(8),0,-3*M_PI_8},{16,0,10,Y(16),0,-3*M_PI_8},
    {24,0,10,Y(24),0,-3*M_PI_8},{0,0,6,Y(0),0,4*M_PI_8},    {8,0,6,Y(8),0,4*M_PI_8},    {16,0,6,Y(16),0,4*M_PI_8},  {24,0,6,Y(24),0,4*M_PI_8}, {0,0,11,Y(0),0,-4*M_PI_8},{8,0,11,Y(8),0,-4*M_PI_8},
    {16,0,11,Y(16),0,-4*M_PI_8},{24,0,11,Y(24),0,-4*M_PI_8},{0,0,7,Y(0),0,5*M_PI_8},    {8,0,7,Y(8),0,5*M_PI_8},    {16,0,7,Y(16),0,5*M_PI_8}, {24,0,7,Y(24),0,5*M_PI_8},{0,0,12,Y(0),0,-5*M_PI_8},
    {8,0,12,Y(8),0,-5*M_PI_8},  {16,0,12,Y(16),0,-5*M_PI_8},{24,0,12,Y(24),0,-5*M_PI_8},{0,0,8,Y(0),0,6*M_PI_8},    {8,0,8,Y(8),0,6*M_PI_8},   {16,0,8,Y(16),0,6*M_PI_8},{24,0,8,Y(24),0,6*M_PI_8},
    {0,0,13,Y(0),0,-6*M_PI_8},  {8,0,13,Y(8),0,-6*M_PI_8},  {16,0,13,Y(16),0,-6*M_PI_8},{24,0,13,Y(24),0,-6*M_PI_8},{0,0,9,Y(0),0,7*M_PI_8},   {8,0,9,Y(8),0,7*M_PI_8},  {16,0,9,Y(16),0,7*M_PI_8},
    {24,0,9,Y(24),0,7*M_PI_8},  {0,0,14,Y(0),0,-7*M_PI_8},  {8,0,14,Y(8),0,-7*M_PI_8},  {16,0,14,Y(16),0,-7*M_PI_8},{24,0,14,Y(24),0,-7*M_PI_8}};

sprite_rotation_t corkscrew_sprite_rotations[80]={
    //Corkscrew sprites
    {0,34,0,Y(0)+CRY(1*M_PI_6),CRP(1*M_PI_6),CRR(1*M_PI_6)},     {8,34,0,Y(8)+CRY(1*M_PI_6),CRP(1*M_PI_6),CRR(1*M_PI_6)},     {16,34,0,Y(16)+CRY(1*M_PI_6),CRP(1*M_PI_6),CRR(1*M_PI_6)},    {24,34,0,Y(24)+CRY(1*M_PI_6),CRP(1*M_PI_6),CRR(1*M_PI_6)},
    {0,35,0,Y(0)+CRY(2*M_PI_6),CRP(2*M_PI_6),CRR(2*M_PI_6)},     {8,35,0,Y(8)+CRY(2*M_PI_6),CRP(2*M_PI_6),CRR(2*M_PI_6)},     {16,35,0,Y(16)+CRY(2*M_PI_6),CRP(2*M_PI_6),CRR(2*M_PI_6)},    {24,35,0,Y(24)+CRY(2*M_PI_6),CRP(2*M_PI_6),CRR(2*M_PI_6)},
    {0,36,0,Y(0)+CRY(3*M_PI_6),CRP(3*M_PI_6),CRR(3*M_PI_6)},     {8,36,0,Y(8)+CRY(3*M_PI_6),CRP(3*M_PI_6),CRR(3*M_PI_6)},     {16,36,0,Y(16)+CRY(3*M_PI_6),CRP(3*M_PI_6),CRR(3*M_PI_6)},    {24,36,0,Y(24)+CRY(3*M_PI_6),CRP(3*M_PI_6),CRR(3*M_PI_6)},
    {0,37,0,Y(0)+CRY(4*M_PI_6),CRP(4*M_PI_6),CRR(4*M_PI_6)},     {8,37,0,Y(8)+CRY(4*M_PI_6),CRP(4*M_PI_6),CRR(4*M_PI_6)},     {16,37,0,Y(16)+CRY(4*M_PI_6),CRP(4*M_PI_6),CRR(4*M_PI_6)},    {24,37,0,Y(24)+CRY(4*M_PI_6),CRP(4*M_PI_6),CRR(4*M_PI_6)},
    {0,38,0,Y(0)+CRY(5*M_PI_6),CRP(5*M_PI_6),CRR(5*M_PI_6)},     {8,38,0,Y(8)+CRY(5*M_PI_6),CRP(5*M_PI_6),CRR(5*M_PI_6)},     {16,38,0,Y(16)+CRY(5*M_PI_6),CRP(5*M_PI_6),CRR(5*M_PI_6)},    {24,38,0,Y(24)+CRY(5*M_PI_6),CRP(5*M_PI_6),CRR(5*M_PI_6)},
    {0,24,0,Y(0)+CLY(1*M_PI_6),CLP(1*M_PI_6),CLR(1*M_PI_6)},     {8,24,0,Y(8)+CLY(1*M_PI_6),CLP(1*M_PI_6),CLR(1*M_PI_6)},     {16,24,0,Y(16)+CLY(1*M_PI_6),CLP(1*M_PI_6),CLR(1*M_PI_6)},    {24,24,0,Y(24)+CLY(1*M_PI_6),CLP(1*M_PI_6),CLR(1*M_PI_6)},
    {0,25,0,Y(0)+CLY(2*M_PI_6),CLP(2*M_PI_6),CLR(2*M_PI_6)},     {8,25,0,Y(8)+CLY(2*M_PI_6),CLP(2*M_PI_6),CLR(2*M_PI_6)},     {16,25,0,Y(16)+CLY(2*M_PI_6),CLP(2*M_PI_6),CLR(2*M_PI_6)},    {24,25,0,Y(24)+CLY(2*M_PI_6),CLP(2*M_PI_6),CLR(2*M_PI_6)},
    {0,26,0,Y(0)+CLY(3*M_PI_6),CLP(3*M_PI_6),CLR(3*M_PI_6)},     {8,26,0,Y(8)+CLY(3*M_PI_6),CLP(3*M_PI_6),CLR(3*M_PI_6)},     {16,26,0,Y(16)+CLY(3*M_PI_6),CLP(3*M_PI_6),CLR(3*M_PI_6)},    {24,26,0,Y(24)+CLY(3*M_PI_6),CLP(3*M_PI_6),CLR(3*M_PI_6)},
    {0,27,0,Y(0)+CLY(4*M_PI_6),CLP(4*M_PI_6),CLR(4*M_PI_6)},     {8,27,0,Y(8)+CLY(4*M_PI_6),CLP(4*M_PI_6),CLR(4*M_PI_6)},     {16,27,0,Y(16)+CLY(4*M_PI_6),CLP(4*M_PI_6),CLR(4*M_PI_6)},    {24,27,0,Y(24)+CLY(4*M_PI_6),CLP(4*M_PI_6),CLR(4*M_PI_6)},
    {0,28,0,Y(0)+CLY(5*M_PI_6),CLP(5*M_PI_6),CLR(5*M_PI_6)},     {8,28,0,Y(8)+CLY(5*M_PI_6),CLP(5*M_PI_6),CLR(5*M_PI_6)},     {16,28,0,Y(16)+CLY(5*M_PI_6),CLP(5*M_PI_6),CLR(5*M_PI_6)},    {24,28,0,Y(24)+CLY(5*M_PI_6),CLP(5*M_PI_6),CLR(5*M_PI_6)},
    {0,39,0,Y(0)+CRY(-1*M_PI_6),CRP(-1*M_PI_6),CRR(-1*M_PI_6)},  {8,39,0,Y(8)+CRY(-1*M_PI_6),CRP(-1*M_PI_6),CRR(-1*M_PI_6)},  {16,39,0,Y(16)+CRY(-1*M_PI_6),CRP(-1*M_PI_6),CRR(-1*M_PI_6)}, {24,39,0,Y(24)+CRY(-1*M_PI_6),CRP(-1*M_PI_6),CRR(-1*M_PI_6)},
    {0,40,0,Y(0)+CRY(-2*M_PI_6),CRP(-2*M_PI_6),CRR(-2*M_PI_6)},  {8,40,0,Y(8)+CRY(-2*M_PI_6),CRP(-2*M_PI_6),CRR(-2*M_PI_6)},  {16,40,0,Y(16)+CRY(-2*M_PI_6),CRP(-2*M_PI_6),CRR(-2*M_PI_6)}, {24,40,0,Y(24)+CRY(-2*M_PI_6),CRP(-2*M_PI_6),CRR(-2*M_PI_6)},
    {0,41,0,Y(0)+CRY(-3*M_PI_6),CRP(-3*M_PI_6),CRR(-3*M_PI_6)},  {8,41,0,Y(8)+CRY(-3*M_PI_6),CRP(-3*M_PI_6),CRR(-3*M_PI_6)},  {16,41,0,Y(16)+CRY(-3*M_PI_6),CRP(-3*M_PI_6),CRR(-3*M_PI_6)}, {24,41,0,Y(24)+CRY(-3*M_PI_6),CRP(-3*M_PI_6),CRR(-3*M_PI_6)},
    {0,42,0,Y(0)+CRY(-4*M_PI_6),CRP(-4*M_PI_6),CRR(-4*M_PI_6)},  {8,42,0,Y(8)+CRY(-4*M_PI_6),CRP(-4*M_PI_6),CRR(-4*M_PI_6)},  {16,42,0,Y(16)+CRY(-4*M_PI_6),CRP(-4*M_PI_6),CRR(-4*M_PI_6)}, {24,42,0,Y(24)+CRY(-4*M_PI_6),CRP(-4*M_PI_6),CRR(-4*M_PI_6)},
    {0,43,0,Y(0)+CRY(-5*M_PI_6),CRP(-5*M_PI_6),CRR(-5*M_PI_6)},  {8,43,0,Y(8)+CRY(-5*M_PI_6),CRP(-5*M_PI_6),CRR(-5*M_PI_6)},  {16,43,0,Y(16)+CRY(-5*M_PI_6),CRP(-5*M_PI_6),CRR(-5*M_PI_6)}, {24,43,0,Y(24)+CRY(-5*M_PI_6),CRP(-5*M_PI_6),CRR(-5*M_PI_6)},
    {0,29,0,Y(0)+CLY(-1*M_PI_6),CLP(-1*M_PI_6),CLR(-1*M_PI_6)},  {8,29,0,Y(8)+CLY(-1*M_PI_6),CLP(-1*M_PI_6),CLR(-1*M_PI_6)},  {16,29,0,Y(16)+CLY(-1*M_PI_6),CLP(-1*M_PI_6),CLR(-1*M_PI_6)}, {24,29,0,Y(24)+CLY(-1*M_PI_6),CLP(-1*M_PI_6),CLR(-1*M_PI_6)},
    {0,30,0,Y(0)+CLY(-2*M_PI_6),CLP(-2*M_PI_6),CLR(-2*M_PI_6)},  {8,30,0,Y(8)+CLY(-2*M_PI_6),CLP(-2*M_PI_6),CLR(-2*M_PI_6)},  {16,30,0,Y(16)+CLY(-2*M_PI_6),CLP(-2*M_PI_6),CLR(-2*M_PI_6)}, {24,30,0,Y(24)+CLY(-2*M_PI_6),CLP(-2*M_PI_6),CLR(-2*M_PI_6)},
    {0,31,0,Y(0)+CLY(-3*M_PI_6),CLP(-3*M_PI_6),CLR(-3*M_PI_6)},  {8,31,0,Y(8)+CLY(-3*M_PI_6),CLP(-3*M_PI_6),CLR(-3*M_PI_6)},  {16,31,0,Y(16)+CLY(-3*M_PI_6),CLP(-3*M_PI_6),CLR(-3*M_PI_6)}, {24,31,0,Y(24)+CLY(-3*M_PI_6),CLP(-3*M_PI_6),CLR(-3*M_PI_6)},
    {0,32,0,Y(0)+CLY(-4*M_PI_6),CLP(-4*M_PI_6),CLR(-4*M_PI_6)},  {8,32,0,Y(8)+CLY(-4*M_PI_6),CLP(-4*M_PI_6),CLR(-4*M_PI_6)},  {16,32,0,Y(16)+CLY(-4*M_PI_6),CLP(-4*M_PI_6),CLR(-4*M_PI_6)}, {24,32,0,Y(24)+CLY(-4*M_PI_6),CLP(-4*M_PI_6),CLR(-4*M_PI_6)},
    {0,33,0,Y(0)+CLY(-5*M_PI_6),CLP(-5*M_PI_6),CLR(-5*M_PI_6)},  {8,33,0,Y(8)+CLY(-5*M_PI_6),CLP(-5*M_PI_6),CLR(-5*M_PI_6)},  {16,33,0,Y(16)+CLY(-5*M_PI_6),CLP(-5*M_PI_6),CLR(-5*M_PI_6)}, {24,33,0,Y(24)+CLY(-5*M_PI_6),CLP(-5*M_PI_6),CLR(-5*M_PI_6)}};

sprite_rotation_t zero_g_orthogonal_sprite_rotations[160]={
    //Gentle up roll sprites
    {0,2,5,Y(0),G,3*M_PI_8},
    {8,2,5,Y(8),G,3*M_PI_8},
    {16,2,5,Y(16),G,3*M_PI_8},
    {24,2,5,Y(24),G,3*M_PI_8},
    {0,2,10,Y(0),G,-3*M_PI_8},
    {8,2,10,Y(8),G,-3*M_PI_8},
    {16,2,10,Y(16),G,-3*M_PI_8},
    {24,2,10,Y(24),G,-3*M_PI_8},
    {0,2,6,Y(0),G,4*M_PI_8},
    {8,2,6,Y(8),G,4*M_PI_8},
    {16,2,6,Y(16),G,4*M_PI_8},
    {24,2,6,Y(24),G,4*M_PI_8},
    {0,2,11,Y(0),G,-4*M_PI_8},
    {8,2,11,Y(8),G,-4*M_PI_8},
    {16,2,11,Y(16),G,-4*M_PI_8},
    {24,2,11,Y(24),G,-4*M_PI_8},
    {0,2,7,Y(0),G,5*M_PI_8},
    {8,2,7,Y(8),G,5*M_PI_8},
    {16,2,7,Y(16),G,5*M_PI_8},
    {24,2,7,Y(24),G,5*M_PI_8},
    {0,2,12,Y(0),G,-5*M_PI_8},
    {8,2,12,Y(8),G,-5*M_PI_8},
    {16,2,12,Y(16),G,-5*M_PI_8},
    {24,2,12,Y(24),G,-5*M_PI_8},
    {0,2,8,Y(0),G,6*M_PI_8},
    {8,2,8,Y(8),G,6*M_PI_8},
    {16,2,8,Y(16),G,6*M_PI_8},
    {24,2,8,Y(24),G,6*M_PI_8},
    {0,2,13,Y(0),G,-6*M_PI_8},
    {8,2,13,Y(8),G,-6*M_PI_8},
    {16,2,13,Y(16),G,-6*M_PI_8},
    {24,2,13,Y(24),G,-6*M_PI_8},
    {0,2,9,Y(0),G,7*M_PI_8},
    {8,2,9,Y(8),G,7*M_PI_8},
    {16,2,9,Y(16),G,7*M_PI_8},
    {24,2,9,Y(24),G,7*M_PI_8},
    {0,2,14,Y(0),G,-7*M_PI_8},
    {8,2,14,Y(8),G,-7*M_PI_8},
    {16,2,14,Y(16),G,-7*M_PI_8},
    {24,2,14,Y(24),G,-7*M_PI_8},
    //Gentle down roll sprites
    {0,6,5,Y(0),-G,3*M_PI_8},
    {8,6,5,Y(8),-G,3*M_PI_8},
    {16,6,5,Y(16),-G,3*M_PI_8},
    {24,6,5,Y(24),-G,3*M_PI_8},
    {0,6,10,Y(0),-G,-3*M_PI_8},
    {8,6,10,Y(8),-G,-3*M_PI_8},
    {16,6,10,Y(16),-G,-3*M_PI_8},
    {24,6,10,Y(24),-G,-3*M_PI_8},
    {0,6,6,Y(0),-G,4*M_PI_8},
    {8,6,6,Y(8),-G,4*M_PI_8},
    {16,6,6,Y(16),-G,4*M_PI_8},
    {24,6,6,Y(24),-G,4*M_PI_8},
    {0,6,11,Y(0),-G,-4*M_PI_8},
    {8,6,11,Y(8),-G,-4*M_PI_8},
    {16,6,11,Y(16),-G,-4*M_PI_8},
    {24,6,11,Y(24),-G,-4*M_PI_8},
    {0,6,7,Y(0),-G,5*M_PI_8},
    {8,6,7,Y(8),-G,5*M_PI_8},
    {16,6,7,Y(16),-G,5*M_PI_8},
    {24,6,7,Y(24),-G,5*M_PI_8},
    {0,6,12,Y(0),-G,-5*M_PI_8},
    {8,6,12,Y(8),-G,-5*M_PI_8},
    {16,6,12,Y(16),-G,-5*M_PI_8},
    {24,6,12,Y(24),-G,-5*M_PI_8},
    {0,6,8,Y(0),-G,6*M_PI_8},
    {8,6,8,Y(8),-G,6*M_PI_8},
    {16,6,8,Y(16),-G,6*M_PI_8},
    {24,6,8,Y(24),-G,6*M_PI_8},
    {0,6,13,Y(0),-G,-6*M_PI_8},
    {8,6,13,Y(8),-G,-6*M_PI_8},
    {16,6,13,Y(16),-G,-6*M_PI_8},
    {24,6,13,Y(24),-G,-6*M_PI_8},
    {0,6,9,Y(0),-G,7*M_PI_8},
    {8,6,9,Y(8),-G,7*M_PI_8},
    {16,6,9,Y(16),-G,7*M_PI_8},
    {24,6,9,Y(24),-G,7*M_PI_8},
    {0,6,14,Y(0),-G,-7*M_PI_8},
    {8,6,14,Y(8),-G,-7*M_PI_8},
    {16,6,14,Y(16),-G,-7*M_PI_8},
    {24,6,14,Y(24),-G,-7*M_PI_8},

    //Steep to gentle up roll sprites
    {0,3,1,Y(0),GS,M_PI_8},
    {8,3,1,Y(8),GS,M_PI_8},
    {16,3,1,Y(16),GS,M_PI_8},
    {24,3,1,Y(24),GS,M_PI_8},
    {0,3,3,Y(0),GS,-M_PI_8},
    {8,3,3,Y(8),GS,-M_PI_8},
    {16,3,3,Y(16),GS,-M_PI_8},
    {24,3,3,Y(24),GS,-M_PI_8},
    {0,3,2,Y(0),GS,M_PI_4},
    {8,3,2,Y(8),GS,M_PI_4},
    {16,3,2,Y(16),GS,M_PI_4},
    {24,3,2,Y(24),GS,M_PI_4},
    {0,3,4,Y(0),GS,-M_PI_4},
    {8,3,4,Y(8),GS,-M_PI_4},
    {16,3,4,Y(16),GS,-M_PI_4},
    {24,3,4,Y(24),GS,-M_PI_4},
    {0,3,5,Y(0),GS,3*M_PI_8},
    {8,3,5,Y(8),GS,3*M_PI_8},
    {16,3,5,Y(16),GS,3*M_PI_8},
    {24,3,5,Y(24),GS,3*M_PI_8},
    {0,3,10,Y(0),GS,-3*M_PI_8},
    {8,3,10,Y(8),GS,-3*M_PI_8},
    {16,3,10,Y(16),GS,-3*M_PI_8},
    {24,3,10,Y(24),GS,-3*M_PI_8},
    {0,3,6,Y(0),GS,4*M_PI_8},
    {8,3,6,Y(8),GS,4*M_PI_8},
    {16,3,6,Y(16),GS,4*M_PI_8},
    {24,3,6,Y(24),GS,4*M_PI_8},
    {0,3,11,Y(0),GS,-4*M_PI_8},
    {8,3,11,Y(8),GS,-4*M_PI_8},
    {16,3,11,Y(16),GS,-4*M_PI_8},
    {24,3,11,Y(24),GS,-4*M_PI_8},
    //Steep to gentle down roll sprites
    {0,7,1,Y(0),-GS,M_PI_8},
    {8,7,1,Y(8),-GS,M_PI_8},
    {16,7,1,Y(16),-GS,M_PI_8},
    {24,7,1,Y(24),-GS,M_PI_8},
    {0,7,3,Y(0),-GS,-M_PI_8},
    {8,7,3,Y(8),-GS,-M_PI_8},
    {16,7,3,Y(16),-GS,-M_PI_8},
    {24,7,3,Y(24),-GS,-M_PI_8},
    {0,7,2,Y(0),-GS,M_PI_4},
    {8,7,2,Y(8),-GS,M_PI_4},
    {16,7,2,Y(16),-GS,M_PI_4},
    {24,7,2,Y(24),-GS,M_PI_4},
    {0,7,4,Y(0),-GS,-M_PI_4},
    {8,7,4,Y(8),-GS,-M_PI_4},
    {16,7,4,Y(16),-GS,-M_PI_4},
    {24,7,4,Y(24),-GS,-M_PI_4},
    {0,7,5,Y(0),-GS,3*M_PI_8},
    {8,7,5,Y(8),-GS,3*M_PI_8},
    {16,7,5,Y(16),-GS,3*M_PI_8},
    {24,7,5,Y(24),-GS,3*M_PI_8},
    {0,7,10,Y(0),-GS,-3*M_PI_8},
    {8,7,10,Y(8),-GS,-3*M_PI_8},
    {16,7,10,Y(16),-GS,-3*M_PI_8},
    {24,7,10,Y(24),-GS,-3*M_PI_8},
    {0,7,6,Y(0),-GS,4*M_PI_8},
    {8,7,6,Y(8),-GS,4*M_PI_8},
    {16,7,6,Y(16),-GS,4*M_PI_8},
    {24,7,6,Y(24),-GS,4*M_PI_8},
    {0,7,11,Y(0),-GS,-4*M_PI_8},
    {8,7,11,Y(8),-GS,-4*M_PI_8},
    {16,7,11,Y(16),-GS,-4*M_PI_8},
    {24,7,11,Y(24),-GS,-4*M_PI_8},
    //Steep up roll sprites
    {0,4,1,Y(0),S,M_PI_8},
    {8,4,1,Y(8),S,M_PI_8},
    {16,4,1,Y(16),S,M_PI_8},
    {24,4,1,Y(24),S,M_PI_8},
    {0,4,3,Y(0),S,-M_PI_8},
    {8,4,3,Y(8),S,-M_PI_8},
    {16,4,3,Y(16),S,-M_PI_8},
    {24,4,3,Y(24),S,-M_PI_8},
    //Steep down roll sprites
    {0,8,1,Y(0),-S,M_PI_8},
    {8,8,1,Y(8),-S,M_PI_8},
    {16,8,1,Y(16),-S,M_PI_8},
    {24,8,1,Y(24),-S,M_PI_8},
    {0,8,3,Y(0),-S,-M_PI_8},
    {8,8,3,Y(8),-S,-M_PI_8},
    {16,8,3,Y(16),-S,-M_PI_8},
    {24,8,3,Y(24),-S,-M_PI_8},
};

sprite_rotation_t zero_g_diagonal_sprite_rotations[160]={
    //Gentle up roll sprites
    {4,2,5,Y(4),G,3*M_PI_8},
    {12,2,5,Y(12),G,3*M_PI_8},
    {20,2,5,Y(20),G,3*M_PI_8},
    {28,2,5,Y(28),G,3*M_PI_8},
    {4,2,10,Y(4),G,-3*M_PI_8},
    {12,2,10,Y(12),G,-3*M_PI_8},
    {20,2,10,Y(20),G,-3*M_PI_8},
    {28,2,10,Y(28),G,-3*M_PI_8},
    {4,2,6,Y(4),G,4*M_PI_8},
    {12,2,6,Y(12),G,4*M_PI_8},
    {20,2,6,Y(20),G,4*M_PI_8},
    {28,2,6,Y(28),G,4*M_PI_8},
    {4,2,11,Y(4),G,-4*M_PI_8},
    {12,2,11,Y(12),G,-4*M_PI_8},
    {20,2,11,Y(20),G,-4*M_PI_8},
    {28,2,11,Y(28),G,-4*M_PI_8},
    {4,2,7,Y(4),G,5*M_PI_8},
    {12,2,7,Y(12),G,5*M_PI_8},
    {20,2,7,Y(20),G,5*M_PI_8},
    {28,2,7,Y(28),G,5*M_PI_8},
    {4,2,12,Y(4),G,-5*M_PI_8},
    {12,2,12,Y(12),G,-5*M_PI_8},
    {20,2,12,Y(20),G,-5*M_PI_8},
    {28,2,12,Y(28),G,-5*M_PI_8},
    {4,2,8,Y(4),G,6*M_PI_8},
    {12,2,8,Y(12),G,6*M_PI_8},
    {20,2,8,Y(20),G,6*M_PI_8},
    {28,2,8,Y(28),G,6*M_PI_8},
    {4,2,13,Y(4),G,-6*M_PI_8},
    {12,2,13,Y(12),G,-6*M_PI_8},
    {20,2,13,Y(20),G,-6*M_PI_8},
    {28,2,13,Y(28),G,-6*M_PI_8},
    {4,2,9,Y(4),G,7*M_PI_8},
    {12,2,9,Y(12),G,7*M_PI_8},
    {20,2,9,Y(20),G,7*M_PI_8},
    {28,2,9,Y(28),G,7*M_PI_8},
    {4,2,14,Y(4),G,-7*M_PI_8},
    {12,2,14,Y(12),G,-7*M_PI_8},
    {20,2,14,Y(20),G,-7*M_PI_8},
    {28,2,14,Y(28),G,-7*M_PI_8},
    //Gentle down roll sprites
    {4,6,5,Y(4),-G,3*M_PI_8},
    {12,6,5,Y(12),-G,3*M_PI_8},
    {20,6,5,Y(20),-G,3*M_PI_8},
    {28,6,5,Y(28),-G,3*M_PI_8},
    {4,6,10,Y(4),-G,-3*M_PI_8},
    {12,6,10,Y(12),-G,-3*M_PI_8},
    {20,6,10,Y(20),-G,-3*M_PI_8},
    {28,6,10,Y(28),-G,-3*M_PI_8},
    {4,6,6,Y(4),-G,4*M_PI_8},
    {12,6,6,Y(12),-G,4*M_PI_8},
    {20,6,6,Y(20),-G,4*M_PI_8},
    {28,6,6,Y(28),-G,4*M_PI_8},
    {4,6,11,Y(4),-G,-4*M_PI_8},
    {12,6,11,Y(12),-G,-4*M_PI_8},
    {20,6,11,Y(20),-G,-4*M_PI_8},
    {28,6,11,Y(28),-G,-4*M_PI_8},
    {4,6,7,Y(4),-G,5*M_PI_8},
    {12,6,7,Y(12),-G,5*M_PI_8},
    {20,6,7,Y(20),-G,5*M_PI_8},
    {28,6,7,Y(28),-G,5*M_PI_8},
    {4,6,12,Y(4),-G,-5*M_PI_8},
    {12,6,12,Y(12),-G,-5*M_PI_8},
    {20,6,12,Y(20),-G,-5*M_PI_8},
    {28,6,12,Y(28),-G,-5*M_PI_8},
    {4,6,8,Y(4),-G,6*M_PI_8},
    {12,6,8,Y(12),-G,6*M_PI_8},
    {20,6,8,Y(20),-G,6*M_PI_8},
    {28,6,8,Y(28),-G,6*M_PI_8},
    {4,6,13,Y(4),-G,-6*M_PI_8},
    {12,6,13,Y(12),-G,-6*M_PI_8},
    {20,6,13,Y(20),-G,-6*M_PI_8},
    {28,6,13,Y(28),-G,-6*M_PI_8},
    {4,6,9,Y(4),-G,7*M_PI_8},
    {12,6,9,Y(12),-G,7*M_PI_8},
    {20,6,9,Y(20),-G,7*M_PI_8},
    {28,6,9,Y(28),-G,7*M_PI_8},
    {4,6,14,Y(4),-G,-7*M_PI_8},
    {12,6,14,Y(12),-G,-7*M_PI_8},
    {20,6,14,Y(20),-G,-7*M_PI_8},
    {28,6,14,Y(28),-G,-7*M_PI_8},

    //Steep to gentle up roll sprites
    {4,3,1,Y(4),GS,M_PI_8},
    {12,3,1,Y(12),GS,M_PI_8},
    {20,3,1,Y(20),GS,M_PI_8},
    {28,3,1,Y(28),GS,M_PI_8},
    {4,3,3,Y(4),GS,-M_PI_8},
    {12,3,3,Y(12),GS,-M_PI_8},
    {20,3,3,Y(20),GS,-M_PI_8},
    {28,3,3,Y(28),GS,-M_PI_8},
    {4,3,2,Y(4),GS,M_PI_4},
    {12,3,2,Y(12),GS,M_PI_4},
    {20,3,2,Y(20),GS,M_PI_4},
    {28,3,2,Y(28),GS,M_PI_4},
    {4,3,4,Y(4),GS,-M_PI_4},
    {12,3,4,Y(12),GS,-M_PI_4},
    {20,3,4,Y(20),GS,-M_PI_4},
    {28,3,4,Y(28),GS,-M_PI_4},
    {4,3,5,Y(4),GS,3*M_PI_8},
    {12,3,5,Y(12),GS,3*M_PI_8},
    {20,3,5,Y(20),GS,3*M_PI_8},
    {28,3,5,Y(28),GS,3*M_PI_8},
    {4,3,10,Y(4),GS,-3*M_PI_8},
    {12,3,10,Y(12),GS,-3*M_PI_8},
    {20,3,10,Y(20),GS,-3*M_PI_8},
    {28,3,10,Y(28),GS,-3*M_PI_8},
    {4,3,6,Y(4),GS,4*M_PI_8},
    {12,3,6,Y(12),GS,4*M_PI_8},
    {20,3,6,Y(20),GS,4*M_PI_8},
    {28,3,6,Y(28),GS,4*M_PI_8},
    {4,3,11,Y(4),GS,-4*M_PI_8},
    {12,3,11,Y(12),GS,-4*M_PI_8},
    {20,3,11,Y(20),GS,-4*M_PI_8},
    {28,3,11,Y(28),GS,-4*M_PI_8},
    //Steep to gentle down roll sprites
    {4,7,1,Y(4),-GS,M_PI_8},
    {12,7,1,Y(12),-GS,M_PI_8},
    {20,7,1,Y(20),-GS,M_PI_8},
    {28,7,1,Y(28),-GS,M_PI_8},
    {4,7,3,Y(4),-GS,-M_PI_8},
    {12,7,3,Y(12),-GS,-M_PI_8},
    {20,7,3,Y(20),-GS,-M_PI_8},
    {28,7,3,Y(28),-GS,-M_PI_8},
    {4,7,2,Y(4),-GS,M_PI_4},
    {12,7,2,Y(12),-GS,M_PI_4},
    {20,7,2,Y(20),-GS,M_PI_4},
    {28,7,2,Y(28),-GS,M_PI_4},
    {4,7,4,Y(4),-GS,-M_PI_4},
    {12,7,4,Y(12),-GS,-M_PI_4},
    {20,7,4,Y(20),-GS,-M_PI_4},
    {28,7,4,Y(28),-GS,-M_PI_4},
    {4,7,5,Y(4),-GS,3*M_PI_8},
    {12,7,5,Y(12),-GS,3*M_PI_8},
    {20,7,5,Y(20),-GS,3*M_PI_8},
    {28,7,5,Y(28),-GS,3*M_PI_8},
    {4,7,10,Y(4),-GS,-3*M_PI_8},
    {12,7,10,Y(12),-GS,-3*M_PI_8},
    {20,7,10,Y(20),-GS,-3*M_PI_8},
    {28,7,10,Y(28),-GS,-3*M_PI_8},
    {4,7,6,Y(4),-GS,4*M_PI_8},
    {12,7,6,Y(12),-GS,4*M_PI_8},
    {20,7,6,Y(20),-GS,4*M_PI_8},
    {28,7,6,Y(28),-GS,4*M_PI_8},
    {4,7,11,Y(4),-GS,-4*M_PI_8},
    {12,7,11,Y(12),-GS,-4*M_PI_8},
    {20,7,11,Y(20),-GS,-4*M_PI_8},
    {28,7,11,Y(28),-GS,-4*M_PI_8},
    //Steep up roll sprites
    {4,4,1,Y(4),S,M_PI_8},
    {12,4,1,Y(12),S,M_PI_8},
    {20,4,1,Y(20),S,M_PI_8},
    {28,4,1,Y(28),S,M_PI_8},
    {4,4,3,Y(4),S,-M_PI_8},
    {12,4,3,Y(12),S,-M_PI_8},
    {20,4,3,Y(20),S,-M_PI_8},
    {28,4,3,Y(28),S,-M_PI_8},
    //Steep down roll sprites
    {4,8,1,Y(4),-S,M_PI_8},
    {12,8,1,Y(12),-S,M_PI_8},
    {20,8,1,Y(20),-S,M_PI_8},
    {28,8,1,Y(28),-S,M_PI_8},
    {4,8,3,Y(4),-S,-M_PI_8},
    {12,8,3,Y(12),-S,-M_PI_8},
    {20,8,3,Y(20),-S,-M_PI_8},
    {28,8,3,Y(28),-S,-M_PI_8},
};

sprite_rotation_t zero_g_other_sprite_rotations[320]={
    //Gentle up roll sprites
    {2,2,5,Y(2),G,3*M_PI_8},
    {10,2,5,Y(10),G,3*M_PI_8},
    {18,2,5,Y(18),G,3*M_PI_8},
    {26,2,5,Y(26),G,3*M_PI_8},
    {2,2,10,Y(2),G,-3*M_PI_8},
    {10,2,10,Y(10),G,-3*M_PI_8},
    {18,2,10,Y(18),G,-3*M_PI_8},
    {26,2,10,Y(26),G,-3*M_PI_8},
    {2,2,6,Y(2),G,4*M_PI_8},
    {10,2,6,Y(10),G,4*M_PI_8},
    {18,2,6,Y(18),G,4*M_PI_8},
    {26,2,6,Y(26),G,4*M_PI_8},
    {2,2,11,Y(2),G,-4*M_PI_8},
    {10,2,11,Y(10),G,-4*M_PI_8},
    {18,2,11,Y(18),G,-4*M_PI_8},
    {26,2,11,Y(26),G,-4*M_PI_8},
    {2,2,7,Y(2),G,5*M_PI_8},
    {10,2,7,Y(10),G,5*M_PI_8},
    {18,2,7,Y(18),G,5*M_PI_8},
    {26,2,7,Y(26),G,5*M_PI_8},
    {2,2,12,Y(2),G,-5*M_PI_8},
    {10,2,12,Y(10),G,-5*M_PI_8},
    {18,2,12,Y(18),G,-5*M_PI_8},
    {26,2,12,Y(26),G,-5*M_PI_8},
    {2,2,8,Y(2),G,6*M_PI_8},
    {10,2,8,Y(10),G,6*M_PI_8},
    {18,2,8,Y(18),G,6*M_PI_8},
    {26,2,8,Y(26),G,6*M_PI_8},
    {2,2,13,Y(2),G,-6*M_PI_8},
    {10,2,13,Y(10),G,-6*M_PI_8},
    {18,2,13,Y(18),G,-6*M_PI_8},
    {26,2,13,Y(26),G,-6*M_PI_8},
    {2,2,9,Y(2),G,7*M_PI_8},
    {10,2,9,Y(10),G,7*M_PI_8},
    {18,2,9,Y(18),G,7*M_PI_8},
    {26,2,9,Y(26),G,7*M_PI_8},
    {2,2,14,Y(2),G,-7*M_PI_8},
    {10,2,14,Y(10),G,-7*M_PI_8},
    {18,2,14,Y(18),G,-7*M_PI_8},
    {26,2,14,Y(26),G,-7*M_PI_8},
    //Gentle down roll sprites
    {2,6,5,Y(2),-G,3*M_PI_8},
    {10,6,5,Y(10),-G,3*M_PI_8},
    {18,6,5,Y(18),-G,3*M_PI_8},
    {26,6,5,Y(26),-G,3*M_PI_8},
    {2,6,10,Y(2),-G,-3*M_PI_8},
    {10,6,10,Y(10),-G,-3*M_PI_8},
    {18,6,10,Y(18),-G,-3*M_PI_8},
    {26,6,10,Y(26),-G,-3*M_PI_8},
    {2,6,6,Y(2),-G,4*M_PI_8},
    {10,6,6,Y(10),-G,4*M_PI_8},
    {18,6,6,Y(18),-G,4*M_PI_8},
    {26,6,6,Y(26),-G,4*M_PI_8},
    {2,6,11,Y(2),-G,-4*M_PI_8},
    {10,6,11,Y(10),-G,-4*M_PI_8},
    {18,6,11,Y(18),-G,-4*M_PI_8},
    {26,6,11,Y(26),-G,-4*M_PI_8},
    {2,6,7,Y(2),-G,5*M_PI_8},
    {10,6,7,Y(10),-G,5*M_PI_8},
    {18,6,7,Y(18),-G,5*M_PI_8},
    {26,6,7,Y(26),-G,5*M_PI_8},
    {2,6,12,Y(2),-G,-5*M_PI_8},
    {10,6,12,Y(10),-G,-5*M_PI_8},
    {18,6,12,Y(18),-G,-5*M_PI_8},
    {26,6,12,Y(26),-G,-5*M_PI_8},
    {2,6,8,Y(2),-G,6*M_PI_8},
    {10,6,8,Y(10),-G,6*M_PI_8},
    {18,6,8,Y(18),-G,6*M_PI_8},
    {26,6,8,Y(26),-G,6*M_PI_8},
    {2,6,13,Y(2),-G,-6*M_PI_8},
    {10,6,13,Y(10),-G,-6*M_PI_8},
    {18,6,13,Y(18),-G,-6*M_PI_8},
    {26,6,13,Y(26),-G,-6*M_PI_8},
    {2,6,9,Y(2),-G,7*M_PI_8},
    {10,6,9,Y(10),-G,7*M_PI_8},
    {18,6,9,Y(18),-G,7*M_PI_8},
    {26,6,9,Y(26),-G,7*M_PI_8},
    {2,6,14,Y(2),-G,-7*M_PI_8},
    {10,6,14,Y(10),-G,-7*M_PI_8},
    {18,6,14,Y(18),-G,-7*M_PI_8},
    {26,6,14,Y(26),-G,-7*M_PI_8},

    //Steep to gentle up roll sprites
    {2,3,1,Y(2),GS,M_PI_8},
    {10,3,1,Y(10),GS,M_PI_8},
    {18,3,1,Y(18),GS,M_PI_8},
    {26,3,1,Y(26),GS,M_PI_8},
    {2,3,3,Y(2),GS,-M_PI_8},
    {10,3,3,Y(10),GS,-M_PI_8},
    {18,3,3,Y(18),GS,-M_PI_8},
    {26,3,3,Y(26),GS,-M_PI_8},
    {2,3,2,Y(2),GS,M_PI_4},
    {10,3,2,Y(10),GS,M_PI_4},
    {18,3,2,Y(18),GS,M_PI_4},
    {26,3,2,Y(26),GS,M_PI_4},
    {2,3,4,Y(2),GS,-M_PI_4},
    {10,3,4,Y(10),GS,-M_PI_4},
    {18,3,4,Y(18),GS,-M_PI_4},
    {26,3,4,Y(26),GS,-M_PI_4},
    {2,3,5,Y(2),GS,3*M_PI_8},
    {10,3,5,Y(10),GS,3*M_PI_8},
    {18,3,5,Y(18),GS,3*M_PI_8},
    {26,3,5,Y(26),GS,3*M_PI_8},
    {2,3,10,Y(2),GS,-3*M_PI_8},
    {10,3,10,Y(10),GS,-3*M_PI_8},
    {18,3,10,Y(18),GS,-3*M_PI_8},
    {26,3,10,Y(26),GS,-3*M_PI_8},
    {2,3,6,Y(2),GS,4*M_PI_8},
    {10,3,6,Y(10),GS,4*M_PI_8},
    {18,3,6,Y(18),GS,4*M_PI_8},
    {26,3,6,Y(26),GS,4*M_PI_8},
    {2,3,11,Y(2),GS,-4*M_PI_8},
    {10,3,11,Y(10),GS,-4*M_PI_8},
    {18,3,11,Y(18),GS,-4*M_PI_8},
    {26,3,11,Y(26),GS,-4*M_PI_8},
    //Steep to gentle down roll sprites
    {2,7,1,Y(2),-GS,M_PI_8},
    {10,7,1,Y(10),-GS,M_PI_8},
    {18,7,1,Y(18),-GS,M_PI_8},
    {26,7,1,Y(26),-GS,M_PI_8},
    {2,7,3,Y(2),-GS,-M_PI_8},
    {10,7,3,Y(10),-GS,-M_PI_8},
    {18,7,3,Y(18),-GS,-M_PI_8},
    {26,7,3,Y(26),-GS,-M_PI_8},
    {2,7,2,Y(2),-GS,M_PI_4},
    {10,7,2,Y(10),-GS,M_PI_4},
    {18,7,2,Y(18),-GS,M_PI_4},
    {26,7,2,Y(26),-GS,M_PI_4},
    {2,7,4,Y(2),-GS,-M_PI_4},
    {10,7,4,Y(10),-GS,-M_PI_4},
    {18,7,4,Y(18),-GS,-M_PI_4},
    {26,7,4,Y(26),-GS,-M_PI_4},
    {2,7,5,Y(2),-GS,3*M_PI_8},
    {10,7,5,Y(10),-GS,3*M_PI_8},
    {18,7,5,Y(18),-GS,3*M_PI_8},
    {26,7,5,Y(26),-GS,3*M_PI_8},
    {2,7,10,Y(2),-GS,-3*M_PI_8},
    {10,7,10,Y(10),-GS,-3*M_PI_8},
    {18,7,10,Y(18),-GS,-3*M_PI_8},
    {26,7,10,Y(26),-GS,-3*M_PI_8},
    {2,7,6,Y(2),-GS,4*M_PI_8},
    {10,7,6,Y(10),-GS,4*M_PI_8},
    {18,7,6,Y(18),-GS,4*M_PI_8},
    {26,7,6,Y(26),-GS,4*M_PI_8},
    {2,7,11,Y(2),-GS,-4*M_PI_8},
    {10,7,11,Y(10),-GS,-4*M_PI_8},
    {18,7,11,Y(18),-GS,-4*M_PI_8},
    {26,7,11,Y(26),-GS,-4*M_PI_8},
    //Steep up roll sprites
    {2,4,1,Y(2),S,M_PI_8},
    {10,4,1,Y(10),S,M_PI_8},
    {18,4,1,Y(18),S,M_PI_8},
    {26,4,1,Y(26),S,M_PI_8},
    {2,4,3,Y(2),S,-M_PI_8},
    {10,4,3,Y(10),S,-M_PI_8},
    {18,4,3,Y(18),S,-M_PI_8},
    {26,4,3,Y(26),S,-M_PI_8},
    //Steep down roll sprites
    {2,8,1,Y(2),-S,M_PI_8},
    {10,8,1,Y(10),-S,M_PI_8},
    {18,8,1,Y(18),-S,M_PI_8},
    {26,8,1,Y(26),-S,M_PI_8},
    {2,8,3,Y(2),-S,-M_PI_8},
    {10,8,3,Y(10),-S,-M_PI_8},
    {18,8,3,Y(18),-S,-M_PI_8},
    {26,8,3,Y(26),-S,-M_PI_8},
    //Gentle up roll sprites
    {6,2,5,Y(6),G,3*M_PI_8},
    {14,2,5,Y(14),G,3*M_PI_8},
    {22,2,5,Y(22),G,3*M_PI_8},
    {30,2,5,Y(30),G,3*M_PI_8},
    {6,2,10,Y(6),G,-3*M_PI_8},
    {14,2,10,Y(14),G,-3*M_PI_8},
    {22,2,10,Y(22),G,-3*M_PI_8},
    {30,2,10,Y(30),G,-3*M_PI_8},
    {6,2,6,Y(6),G,4*M_PI_8},
    {14,2,6,Y(14),G,4*M_PI_8},
    {22,2,6,Y(22),G,4*M_PI_8},
    {30,2,6,Y(30),G,4*M_PI_8},
    {6,2,11,Y(6),G,-4*M_PI_8},
    {14,2,11,Y(14),G,-4*M_PI_8},
    {22,2,11,Y(22),G,-4*M_PI_8},
    {30,2,11,Y(30),G,-4*M_PI_8},
    {6,2,7,Y(6),G,5*M_PI_8},
    {14,2,7,Y(14),G,5*M_PI_8},
    {22,2,7,Y(22),G,5*M_PI_8},
    {30,2,7,Y(30),G,5*M_PI_8},
    {6,2,12,Y(6),G,-5*M_PI_8},
    {14,2,12,Y(14),G,-5*M_PI_8},
    {22,2,12,Y(22),G,-5*M_PI_8},
    {30,2,12,Y(30),G,-5*M_PI_8},
    {6,2,8,Y(6),G,6*M_PI_8},
    {14,2,8,Y(14),G,6*M_PI_8},
    {22,2,8,Y(22),G,6*M_PI_8},
    {30,2,8,Y(30),G,6*M_PI_8},
    {6,2,13,Y(6),G,-6*M_PI_8},
    {14,2,13,Y(14),G,-6*M_PI_8},
    {22,2,13,Y(22),G,-6*M_PI_8},
    {30,2,13,Y(30),G,-6*M_PI_8},
    {6,2,9,Y(6),G,7*M_PI_8},
    {14,2,9,Y(14),G,7*M_PI_8},
    {22,2,9,Y(22),G,7*M_PI_8},
    {30,2,9,Y(30),G,7*M_PI_8},
    {6,2,14,Y(6),G,-7*M_PI_8},
    {14,2,14,Y(14),G,-7*M_PI_8},
    {22,2,14,Y(22),G,-7*M_PI_8},
    {30,2,14,Y(30),G,-7*M_PI_8},
    //Gentle down roll sprites
    {6,6,5,Y(6),-G,3*M_PI_8},
    {14,6,5,Y(14),-G,3*M_PI_8},
    {22,6,5,Y(22),-G,3*M_PI_8},
    {30,6,5,Y(30),-G,3*M_PI_8},
    {6,6,10,Y(6),-G,-3*M_PI_8},
    {14,6,10,Y(14),-G,-3*M_PI_8},
    {22,6,10,Y(22),-G,-3*M_PI_8},
    {30,6,10,Y(30),-G,-3*M_PI_8},
    {6,6,6,Y(6),-G,4*M_PI_8},
    {14,6,6,Y(14),-G,4*M_PI_8},
    {22,6,6,Y(22),-G,4*M_PI_8},
    {30,6,6,Y(30),-G,4*M_PI_8},
    {6,6,11,Y(6),-G,-4*M_PI_8},
    {14,6,11,Y(14),-G,-4*M_PI_8},
    {22,6,11,Y(22),-G,-4*M_PI_8},
    {30,6,11,Y(30),-G,-4*M_PI_8},
    {6,6,7,Y(6),-G,5*M_PI_8},
    {14,6,7,Y(14),-G,5*M_PI_8},
    {22,6,7,Y(22),-G,5*M_PI_8},
    {30,6,7,Y(30),-G,5*M_PI_8},
    {6,6,12,Y(6),-G,-5*M_PI_8},
    {14,6,12,Y(14),-G,-5*M_PI_8},
    {22,6,12,Y(22),-G,-5*M_PI_8},
    {30,6,12,Y(30),-G,-5*M_PI_8},
    {6,6,8,Y(6),-G,6*M_PI_8},
    {14,6,8,Y(14),-G,6*M_PI_8},
    {22,6,8,Y(22),-G,6*M_PI_8},
    {30,6,8,Y(30),-G,6*M_PI_8},
    {6,6,13,Y(6),-G,-6*M_PI_8},
    {14,6,13,Y(14),-G,-6*M_PI_8},
    {22,6,13,Y(22),-G,-6*M_PI_8},
    {30,6,13,Y(30),-G,-6*M_PI_8},
    {6,6,9,Y(6),-G,7*M_PI_8},
    {14,6,9,Y(14),-G,7*M_PI_8},
    {22,6,9,Y(22),-G,7*M_PI_8},
    {30,6,9,Y(30),-G,7*M_PI_8},
    {6,6,14,Y(6),-G,-7*M_PI_8},
    {14,6,14,Y(14),-G,-7*M_PI_8},
    {22,6,14,Y(22),-G,-7*M_PI_8},
    {30,6,14,Y(30),-G,-7*M_PI_8},

    //Steep to gentle up roll sprites
    {6,3,1,Y(6),GS,M_PI_8},
    {14,3,1,Y(14),GS,M_PI_8},
    {22,3,1,Y(22),GS,M_PI_8},
    {30,3,1,Y(30),GS,M_PI_8},
    {6,3,3,Y(6),GS,-M_PI_8},
    {14,3,3,Y(14),GS,-M_PI_8},
    {22,3,3,Y(22),GS,-M_PI_8},
    {30,3,3,Y(30),GS,-M_PI_8},
    {6,3,2,Y(6),GS,M_PI_4},
    {14,3,2,Y(14),GS,M_PI_4},
    {22,3,2,Y(22),GS,M_PI_4},
    {30,3,2,Y(30),GS,M_PI_4},
    {6,3,4,Y(6),GS,-M_PI_4},
    {14,3,4,Y(14),GS,-M_PI_4},
    {22,3,4,Y(22),GS,-M_PI_4},
    {30,3,4,Y(30),GS,-M_PI_4},
    {6,3,5,Y(6),GS,3*M_PI_8},
    {14,3,5,Y(14),GS,3*M_PI_8},
    {22,3,5,Y(22),GS,3*M_PI_8},
    {30,3,5,Y(30),GS,3*M_PI_8},
    {6,3,10,Y(6),GS,-3*M_PI_8},
    {14,3,10,Y(14),GS,-3*M_PI_8},
    {22,3,10,Y(22),GS,-3*M_PI_8},
    {30,3,10,Y(30),GS,-3*M_PI_8},
    {6,3,6,Y(6),GS,4*M_PI_8},
    {14,3,6,Y(14),GS,4*M_PI_8},
    {22,3,6,Y(22),GS,4*M_PI_8},
    {30,3,6,Y(30),GS,4*M_PI_8},
    {6,3,11,Y(6),GS,-4*M_PI_8},
    {14,3,11,Y(14),GS,-4*M_PI_8},
    {22,3,11,Y(22),GS,-4*M_PI_8},
    {30,3,11,Y(30),GS,-4*M_PI_8},
    //Steep to gentle down roll sprites
    {6,7,1,Y(6),-GS,M_PI_8},
    {14,7,1,Y(14),-GS,M_PI_8},
    {22,7,1,Y(22),-GS,M_PI_8},
    {30,7,1,Y(30),-GS,M_PI_8},
    {6,7,3,Y(6),-GS,-M_PI_8},
    {14,7,3,Y(14),-GS,-M_PI_8},
    {22,7,3,Y(22),-GS,-M_PI_8},
    {30,7,3,Y(30),-GS,-M_PI_8},
    {6,7,2,Y(6),-GS,M_PI_4},
    {14,7,2,Y(14),-GS,M_PI_4},
    {22,7,2,Y(22),-GS,M_PI_4},
    {30,7,2,Y(30),-GS,M_PI_4},
    {6,7,4,Y(6),-GS,-M_PI_4},
    {14,7,4,Y(14),-GS,-M_PI_4},
    {22,7,4,Y(22),-GS,-M_PI_4},
    {30,7,4,Y(30),-GS,-M_PI_4},
    {6,7,5,Y(6),-GS,3*M_PI_8},
    {14,7,5,Y(14),-GS,3*M_PI_8},
    {22,7,5,Y(22),-GS,3*M_PI_8},
    {30,7,5,Y(30),-GS,3*M_PI_8},
    {6,7,10,Y(6),-GS,-3*M_PI_8},
    {14,7,10,Y(14),-GS,-3*M_PI_8},
    {22,7,10,Y(22),-GS,-3*M_PI_8},
    {30,7,10,Y(30),-GS,-3*M_PI_8},
    {6,7,6,Y(6),-GS,4*M_PI_8},
    {14,7,6,Y(14),-GS,4*M_PI_8},
    {22,7,6,Y(22),-GS,4*M_PI_8},
    {30,7,6,Y(30),-GS,4*M_PI_8},
    {6,7,11,Y(6),-GS,-4*M_PI_8},
    {14,7,11,Y(14),-GS,-4*M_PI_8},
    {22,7,11,Y(22),-GS,-4*M_PI_8},
    {30,7,11,Y(30),-GS,-4*M_PI_8},
    //Steep up roll sprites
    {6,4,1,Y(6),S,M_PI_8},
    {14,4,1,Y(14),S,M_PI_8},
    {22,4,1,Y(22),S,M_PI_8},
    {30,4,1,Y(30),S,M_PI_8},
    {6,4,3,Y(6),S,-M_PI_8},
    {14,4,3,Y(14),S,-M_PI_8},
    {22,4,3,Y(22),S,-M_PI_8},
    {30,4,3,Y(30),S,-M_PI_8},
    //Steep down roll sprites
    {6,8,1,Y(6),-S,M_PI_8},
    {14,8,1,Y(14),-S,M_PI_8},
    {22,8,1,Y(22),-S,M_PI_8},
    {30,8,1,Y(30),-S,M_PI_8},
    {6,8,3,Y(6),-S,-M_PI_8},
    {14,8,3,Y(14),-S,-M_PI_8},
    {22,8,3,Y(22),-S,-M_PI_8},
    {30,8,3,Y(30),-S,-M_PI_8},
};

sprite_rotation_t dive_loop_sprite_rotations[144]={

	//Steep up 22.5 bank
	{4,4,1,Y(4),S,M_PI_8},
	{12,4,1,Y(12),S,M_PI_8},
	{20,4,1,Y(20),S,M_PI_8},
	{28,4,1,Y(28),S,M_PI_8},
	{4,4,3,Y(4),S,-M_PI_8},
	{12,4,3,Y(12),S,-M_PI_8},
	{20,4,3,Y(20),S,-M_PI_8},
	{28,4,3,Y(28),S,-M_PI_8},
	//Steep down 22.5 bank
	{4,8,1,Y(4),-S,M_PI_8},
	{12,8,1,Y(12),-S,M_PI_8},
	{20,8,1,Y(20),-S,M_PI_8},
	{28,8,1,Y(28),-S,M_PI_8},
	{4,8,3,Y(4),-S,-M_PI_8},
	{12,8,3,Y(12),-S,-M_PI_8},
	{20,8,3,Y(20),-S,-M_PI_8},
	{28,8,3,Y(28),-S,-M_PI_8},

	//Diagonal steep up 45 bank
	{2, 52,2,Y(2),SD,M_PI_4},
	{6, 52,2,Y(6),SD,M_PI_4},
	{10,52,2,Y(10),SD,M_PI_4},
	{14,52,2,Y(14),SD,M_PI_4},
	{18,52,2,Y(18),SD,M_PI_4},
	{22,52,2,Y(22),SD,M_PI_4},
	{26,52,2,Y(26),SD,M_PI_4},
	{30,52,2,Y(30),SD,M_PI_4},
	{2, 52,4,Y(2),SD,-M_PI_4},
	{6, 52,4,Y(6),SD,-M_PI_4},
	{10,52,4,Y(10),SD,-M_PI_4},
	{14,52,4,Y(14),SD,-M_PI_4},
	{18,52,4,Y(18),SD,-M_PI_4},
	{22,52,4,Y(22),SD,-M_PI_4},
	{26,52,4,Y(26),SD,-M_PI_4},
	{30,52,4,Y(30),SD,-M_PI_4},
	
	//Diagonal steep down 45 bank
	{2, 55,2,Y(2),-SD,M_PI_4},
	{6, 55,2,Y(6),-SD,M_PI_4},
	{10,55,2,Y(10),-SD,M_PI_4},
	{14,55,2,Y(14),-SD,M_PI_4},
	{18,55,2,Y(18),-SD,M_PI_4},
	{22,55,2,Y(22),-SD,M_PI_4},
	{26,55,2,Y(26),-SD,M_PI_4},
	{30,55,2,Y(30),-SD,M_PI_4},
	{2, 55,4,Y(2),-SD,-M_PI_4},
	{6, 55,4,Y(6),-SD,-M_PI_4},
	{10,55,4,Y(10),-SD,-M_PI_4},
	{14,55,4,Y(14),-SD,-M_PI_4},
	{18,55,4,Y(18),-SD,-M_PI_4},
	{22,55,4,Y(22),-SD,-M_PI_4},
	{26,55,4,Y(26),-SD,-M_PI_4},
	{30,55,4,Y(30),-SD,-M_PI_4},
	
	
	//Diagonal steep up 67 bank
	{2, 52,5,Y(2),SD,3*M_PI_8},
	{6, 52,5,Y(6),SD,3*M_PI_8},
	{10,52,5,Y(10),SD,3*M_PI_8},
	{14,52,5,Y(14),SD,3*M_PI_8},
	{18,52,5,Y(18),SD,3*M_PI_8},
	{22,52,5,Y(22),SD,3*M_PI_8},
	{26,52,5,Y(26),SD,3*M_PI_8},
	{30,52,5,Y(30),SD,3*M_PI_8},
	{2, 52,10,Y(2),SD,-3*M_PI_8},
	{6, 52,10,Y(6),SD,-3*M_PI_8},
	{10,52,10,Y(10),SD,-3*M_PI_8},
	{14,52,10,Y(14),SD,-3*M_PI_8},
	{18,52,10,Y(18),SD,-3*M_PI_8},
	{22,52,10,Y(22),SD,-3*M_PI_8},
	{26,52,10,Y(26),SD,-3*M_PI_8},
	{30,52,10,Y(30),SD,-3*M_PI_8},
	
	//Diagonal steep down 67 bank
	{2, 55,5,Y(2),-SD,3*M_PI_8},
	{6, 55,5,Y(6),-SD,3*M_PI_8},
	{10,55,5,Y(10),-SD,3*M_PI_8},
	{14,55,5,Y(14),-SD,3*M_PI_8},
	{18,55,5,Y(18),-SD,3*M_PI_8},
	{22,55,5,Y(22),-SD,3*M_PI_8},
	{26,55,5,Y(26),-SD,3*M_PI_8},
	{30,55,5,Y(30),-SD,3*M_PI_8},
	{2, 55,10,Y(2),-SD,-3*M_PI_8},
	{6, 55,10,Y(6),-SD,-3*M_PI_8},
	{10,55,10,Y(10),-SD,-3*M_PI_8},
	{14,55,10,Y(14),-SD,-3*M_PI_8},
	{18,55,10,Y(18),-SD,-3*M_PI_8},
	{22,55,10,Y(22),-SD,-3*M_PI_8},
	{26,55,10,Y(26),-SD,-3*M_PI_8},
	{30,55,10,Y(30),-SD,-3*M_PI_8},
	
	//Diagonal steep up 90 bank
	{2, 52,6,Y(2),SD,M_PI_2},
	{6, 52,6,Y(6),SD,M_PI_2},
	{10,52,6,Y(10),SD,M_PI_2},
	{14,52,6,Y(14),SD,M_PI_2},
	{18,52,6,Y(18),SD,M_PI_2},
	{22,52,6,Y(22),SD,M_PI_2},
	{26,52,6,Y(26),SD,M_PI_2},
	{30,52,6,Y(30),SD,M_PI_2},
	{2, 52,11,Y(2),SD,-M_PI_2},
	{6, 52,11,Y(6),SD,-M_PI_2},
	{10,52,11,Y(10),SD,-M_PI_2},
	{14,52,11,Y(14),SD,-M_PI_2},
	{18,52,11,Y(18),SD,-M_PI_2},
	{22,52,11,Y(22),SD,-M_PI_2},
	{26,52,11,Y(26),SD,-M_PI_2},
	{30,52,11,Y(30),SD,-M_PI_2},
	
	//Diagonal steep down 90 bank
	{2, 55,6,Y(2),-SD,M_PI_2},
	{6, 55,6,Y(6),-SD,M_PI_2},
	{10,55,6,Y(10),-SD,M_PI_2},
	{14,55,6,Y(14),-SD,M_PI_2},
	{18,55,6,Y(18),-SD,M_PI_2},
	{22,55,6,Y(22),-SD,M_PI_2},
	{26,55,6,Y(26),-SD,M_PI_2},
	{30,55,6,Y(30),-SD,M_PI_2},
	{2, 55,11,Y(2),-SD,-M_PI_2},
	{6, 55,11,Y(6),-SD,-M_PI_2},
	{10,55,11,Y(10),-SD,-M_PI_2},
	{14,55,11,Y(14),-SD,-M_PI_2},
	{18,55,11,Y(18),-SD,-M_PI_2},
	{22,55,11,Y(22),-SD,-M_PI_2},
	{26,55,11,Y(26),-SD,-M_PI_2},
	{30,55,11,Y(30),-SD,-M_PI_2},


	//Non rendered - use corkscrew fallback

	//Gentle-steep up 90 bank
	{4, 3,6,Y(4),GS,M_PI_2},
	{12,3,6,Y(12),GS,M_PI_2},
	{20,3,6,Y(20),GS,M_PI_2},
	{28,3,6,Y(28),GS,M_PI_2},
	{4, 3,11,Y(4),GS,-M_PI_2},
	{12,3,11,Y(12),GS,-M_PI_2},
	{20,3,11,Y(20),GS,-M_PI_2},
	{28,3,11,Y(28),GS,-M_PI_2},
	
	//Gentle-steep down 90 bank
	{4, 7,6,Y(4),-GS,M_PI_2},
	{12,7,6,Y(12),-GS,M_PI_2},
	{20,7,6,Y(20),-GS,M_PI_2},
	{28,7,6,Y(28),-GS,M_PI_2},
	{4, 7,11,Y(4),-GS,-M_PI_2},
	{12,7,11,Y(12),-GS,-M_PI_2},
	{20,7,11,Y(20),-GS,-M_PI_2},
	{28,7,11,Y(28),-GS,-M_PI_2},
	
	
	//Gentle-steep up 135 bank
	{2, 3,8,Y(2),GS,6*M_PI_8},
	{10,3,8,Y(10),GS,6*M_PI_8},
	{18,3,8,Y(18),GS,6*M_PI_8},
	{26,3,8,Y(26),GS,6*M_PI_8},
	{6, 3,13,Y(6),GS,-6*M_PI_8},
	{14,3,13,Y(14),GS,-6*M_PI_8},
	{22,3,13,Y(22),GS,-6*M_PI_8},
	{30,3,13,Y(30),GS,-6*M_PI_8},
	
	//Gentle-steep down 135 bank
	{6, 7,8,Y(6),-GS,6*M_PI_8},
	{14,7,8,Y(14),-GS,6*M_PI_8},
	{22,7,8,Y(22),-GS,6*M_PI_8},
	{30,7,8,Y(30),-GS,6*M_PI_8},
	{2, 7,13,Y(2),-GS,-6*M_PI_8},
	{10,7,13,Y(10),-GS,-6*M_PI_8},
	{18,7,13,Y(18),-GS,-6*M_PI_8},
	{26,7,13,Y(26),-GS,-6*M_PI_8},
};

#define NUM_SPRITE_GROUPS 9
int sprite_group_counts[NUM_SPRITE_GROUPS]={176,172,408,40,80,160,160,320,144};
const sprite_rotation_t* sprite_group_rotations[NUM_SPRITE_GROUPS]={orthogonal_sprite_rotations,diagonal_sprite_rotations,turn_sprite_rotations,inline_twist_sprite_rotations,corkscrew_sprite_rotations,zero_g_orthogonal_sprite_rotations,zero_g_diagonal_sprite_rotations,zero_g_other_sprite_rotations,dive_loop_sprite_rotations};

matrix_t track_point_get_rotation(track_point_t point)
{
	return matrix(point.tangent.z,point.normal.z,-point.binormal.z,point.tangent.y,point.normal.y,-point.binormal.y,point.tangent.x,point.normal.x,-point.binormal.x);
}

float get_rotation_distance(matrix_t a,matrix_t b)
{
	matrix_t diff=matrix_mult(a,matrix_transpose(b));
	float arg=(diff.entries[0]+diff.entries[4]+diff.entries[8]-1.0)/2.0;
	if(arg <=-1)return M_PI;
	else if(arg >=1.0)return 0;
	return acos(arg);
}


void print_euler(matrix_t rotation)
{
	vector3_t tangent=vector3(rotation.entries[6],rotation.entries[3],rotation.entries[0]);
	vector3_t normal=vector3(rotation.entries[7],rotation.entries[4],rotation.entries[1]);
	vector3_t binormal_upright=vector3_normalize(vector3_cross(tangent,vector3(0,1,0)));
	vector3_t normal_upright=vector3_cross(tangent,binormal_upright);
	float yaw=atan2(-tangent.x,tangent.z);
	float pitch=atan2(tangent.y,sqrt(tangent.x*tangent.x+tangent.z*tangent.z));
	float roll=atan2(-vector3_dot(normal,binormal_upright),-vector3_dot(normal,normal_upright));
	printf("Euler \t%.1f\t%.1f\t%.1f\n",yaw*180/M_PI,pitch*180/M_PI,roll*180/M_PI);
}


sprite_rotation_t get_closest_rotation(matrix_t rotation,int groups)
{
//	putchar('\n');
//	print_euler(rotation);

	float min_dist=1000.0;
	sprite_rotation_t min_rotation;


	for(int j=0; j<NUM_SPRITE_GROUPS; j++)
	{
		if(!(groups&(1<<j)))continue;
		const sprite_rotation_t* sprite_rotations=sprite_group_rotations[j];
		//printf("Sprite group %d\n",j)
		for(int i=0; i<sprite_group_counts[j]; i++)
		{
			matrix_t candidate_rotation=matrix_mult(matrix_mult(rotate_y(sprite_rotations[i].yaw),rotate_z(sprite_rotations[i].pitch)),rotate_x(sprite_rotations[i].roll));

			float dist=get_rotation_distance(rotation,candidate_rotation);
			//printf("Candidate rotation %.1f %.1f %.1f\n",sprite_rotations[i].yaw*180/M_PI,sprite_rotations[i].pitch*180/M_PI,sprite_rotations[i].roll*180/M_PI);
			if(dist<min_dist)
			{
			//printf("Candidate sprites %d %d %d Dist %f\n\n",sprite_rotations[i].yaw_sprite,sprite_rotations[i].pitch_sprite,sprite_rotations[i].bank_sprite,dist);
				min_dist=dist;
				min_rotation=sprite_rotations[i];
			}
		}
	}

/*
		for(int i=0; i<32; i+=2)
		for(int j=0; j<18; j++)
		for(int k=0; k<15; k++)
		{
		sprite_rotation_t sprite_rotation={i,pitch_numbers[j],k,(float)Y(i),pitch_angles[j],bank_angles[k]};
		matrix_t candidate_rotation=matrix_mult(matrix_mult(rotate_y(sprite_rotation.yaw),rotate_z(sprite_rotation.pitch)),rotate_x(sprite_rotation.roll));
			float dist=get_rotation_distance(rotation,candidate_rotation);
			if(dist<min_dist)
			{
				min_dist=dist;
				min_rotation=sprite_rotation;
			}

		}
*/

//	printf("Angle\t%.1f\t%.1f\t%.1f Dist %f\n",min_rotation.yaw*180/M_PI,min_rotation.pitch*180/M_PI,min_rotation.roll*180/M_PI,min_dist);
	return min_rotation;
}


void calc_g_forces(track_section_t* track_section,double dist,int count)
{
	double h=0.001;
	float reference=1.0/(2.5*TILE_SIZE);

	int length=(int)floor(0.5+32.0*(track_section->length/TILE_SIZE));

	track_point_t x=track_section->curve(dist);
	track_point_t y=track_section->curve(dist+h);

	vector3_t curvature=vector3_mult(vector3_sub(x.tangent,y.tangent),1/h);

	float vertical_factor=-vector3_dot(curvature,x.normal);
	float lateral_factor=vector3_dot(curvature,x.binormal);

	//total_lat+=lateral_factor;
	//total_vert+=vertical_factor;
	printf("%d:\t%d %d %d\n",count,fabs(vertical_factor)<0.0001 ? 0 : (int)round(98.0*reference/vertical_factor),fabs(lateral_factor)<0.0001 ? 0 : (int)round(98.0*reference/lateral_factor),380-2*count);

	int t=70;
	int c=67+2*(152);
	//	if(i>t)printf("%d\n",c-2*i);
	//float lateral_factor=total_lat/length;
	//float vertical_factor=total_vert/length;
	//printf("%f\n",lateral_factor);
	//printf("%d %d\n",fabs(vertical_factor)<0.0001 ? 0 : (int)round(98.0*reference/vertical_factor),fabs(lateral_factor)<0.0001 ? 0 : (int)round(98.0*reference/lateral_factor));
}



typedef struct
{
	int x;
	int y;
	int z;
}coord_t;

coord_t get_subposition(vector3_t point,int view,int diag)
{
	coord_t sub;
	sub.x=(int)round(32.0*point.z/TILE_SIZE);
	sub.y=(int)round(32.0*point.x/TILE_SIZE);
	sub.z=(int)round(((16*sqrt(6))*(point.y)/TILE_SIZE));
	int t;
	switch(view+4*diag)
	{
	case 0:
		sub.x=(32-sub.x);
		sub.y=(16-sub.y);
		break;
	case 1:
		t=sub.x;
		sub.x=(16-sub.y);
		sub.y=t;
		break;
	case 2:
		sub.y=(16+sub.y);
		break;
	case 3:
		t=sub.x;
		sub.x=(16+sub.y);
		sub.y=(32-t);
		break;
	case 4:
		sub.x=(16-sub.x);
		sub.y=(15-sub.y);
		break;
	case 5:
		t=sub.x;
		sub.x=(16-sub.y);
		sub.y=(16+t);
		break;
	case 6:
		sub.x=(16+sub.x);
		sub.y=(15+sub.y);
		break;
	case 7:
		t=sub.x;
		sub.x=(16+sub.y);
		sub.y=(16-t);
		break;
	}
	return sub;
}

int calc_differing_coords(coord_t sub1,coord_t sub2)
{
	int dx=abs(sub1.x-sub2.x);
	int dy=abs(sub1.y-sub2.y);
	int dz=abs(sub1.z-sub2.z);

	if(dx>1||dy>1||dz>1)return -1;

	int n=0;
	if(dx ==1)n++;
	if(dy ==1)n++;
	if(dz ==1)n++;
	return n;
}

track_point_t get_track_point(track_section_t* track_section,float progress,int reverse,matrix_t reverse_transform,vector3_t reverse_offset)
{
	track_point_t point;
	if(!reverse)point=track_section->curve(progress);
	else
	{
		point=track_section->curve(progress);
		point.position=matrix_vector(reverse_transform,vector3_sub(point.position,reverse_offset));
		point.tangent=vector3_mult(matrix_vector(reverse_transform,point.tangent),-1.0);
		point.normal=matrix_vector(reverse_transform,point.normal);
		point.binormal=vector3_mult(matrix_vector(reverse_transform,point.binormal),-1.0);
	}
	return point;
}

//Generate the subposition data for a track piece
//Reverse value is difference in height (in pixels)between final tile element base and track element end +1
//Inverted track is 3 pixels higher than upright track of same height
int generate_view_subposition_data(track_section_t* track_section,int groups,int view,int reverse,subposition_t* points)
{
//Calculate start and finish angles
track_point_t start=track_section->curve(0);
int start_angle=(int)roundf(4.0*atan2(-start.tangent.x,start.tangent.z)/M_PI);
if(start_angle<0)start_angle+=8;
track_point_t end=track_section->curve(track_section->length);
int finish_angle=(int)roundf(4.0*atan2(-end.tangent.x,end.tangent.z)/M_PI);
if(finish_angle<0)finish_angle+=8;

matrix_t reverse_transform;
vector3_t reverse_offset;
	if(reverse)
	{
	reverse_transform=rotate_y(M_PI_4*((finish_angle&0xFE)+4));
	reverse_offset=end.position;
	reverse_offset.y=round(8*reverse_offset.y/CLEARANCE_HEIGHT-(reverse-1))*CLEARANCE_HEIGHT/8.0;
	int rot=(finish_angle&0xFE)+4;
	int tmp=start_angle;
	start_angle=(finish_angle+rot) % 8;
	finish_angle=(tmp+rot) % 8;
	}
//Check if element starts on a diagonal
int diag=start_angle&1;

/*
printf("View %d\n",view);
printf("Diagonal %d\n",diag);
printf("Start angle %d\n",start_angle);
printf("Finish angle %d\n",finish_angle);
printf("Skip start %d\n",view==0||view==3);
printf("Skip finish %d %d\n",(((finish_angle&0xFE)+2*view)%8==2)||(((finish_angle&0xFE)+2*view)%8==4),((finish_angle&0xFE)+2*view)%8);
*/
int end_angle=((finish_angle&0xFE)+2*view) % 8;
int skip_start=view==0||view==3;
int skip_final=0;//end_angle ==2||end_angle ==4;

int count=0;
int done=0;
float progress=0;
	while(!done)
	{
	//Check if this is the last point
		if(progress >=track_section->length)
		{
		progress=track_section->length;
		done=1;
		}

	//Get closest rotation
	track_point_t point=get_track_point(track_section,progress,reverse,reverse_transform,reverse_offset);
	coord_t cur_sub=get_subposition(point.position,view,diag);

	//calc_g_forces(track_section,progress,count);	
	
	//Write data
	//Skip first point for view angles 0 and 3
		if(((reverse||!skip_start)&&(!reverse||!skip_final))||progress !=0)
		{
		sprite_rotation_t rotation=get_closest_rotation(track_point_get_rotation(point),groups);
		//float h=sqrt(point.tangent.x*point.tangent.x+point.tangent.z*point.tangent.z);
		//printf("Pitch %.1f (%d %d %d)\n",atan2(point.tangent.y,h)*180/M_PI,rotation.yaw_sprite,rotation.pitch_sprite,rotation.bank_sprite);

		subposition_t point={cur_sub.x,cur_sub.y,cur_sub.z,(8*view+rotation.yaw_sprite) % 32,rotation.pitch_sprite,rotation.bank_sprite};
		points[count]=point;
		count++;
			if(count==MAX_SUBPOSITION_POINTS)
			{
			printf("MAX_SUBPOSITION_POINTS exceeded\n");
			return count;
			}
		}

	//Get next subposition point
	int i=0;
		do
		{
		//Get position of track point
		track_point_t point=get_track_point(track_section,progress+0.01*i,reverse,reverse_transform,reverse_offset);
		coord_t sub=get_subposition(point.position,view,diag);
		//printf("New sub %d %d %d\n",sub.x,sub.y,sub.z);
		int n=calc_differing_coords(cur_sub,sub);
		//printf("Diff %d\n",n);
			if(n<0)
			{
			//if(count%10!=0)
			i--;
			break;
			}
		i++;
		}while(progress+0.01*i<track_section->length);
	progress+=0.01*i;
	//printf("Progress %f\n",progress);
	}

//Skip last point
	if((!reverse&&skip_final)||(reverse&&skip_start))count--;

//If in reverse, reverse the list
	if(reverse)
	{
		for(int i=0;i<count/2;i++)
		{
		subposition_t temp=points[i];
		points[i]=points[(count-1)-i];
		points[(count-1)-i]=temp;
		}
	}
return count;
}

void print_subposition_data(subposition_t* points,int num_points,const char* name,int view)
{
printf("CREATE_VEHICLE_INFO(TrackVehicleInfo%s%d,{\n",name,view);
	for(int i=0;i<num_points;i++)
	{
			if(i % 5 ==0)
			{
			printf("    ");
			}
		printf("{% 7d,% 5d,% 5d,% 3d, % 8s, % 8s },",points[i].x,points[i].y,points[i].z,points[i].yaw_sprite,pitch_names[points[i].pitch_sprite],bank_names[points[i].bank_sprite]);
			if(i % 5 ==4)putchar('\n');
	}
puts("})\n");
}

const int32_t subposition_translation[]=
	{
	0,      // no movement
	8716,   // X translation
	8716,   // Y translation
	12327,  // XY translation
	6554,   // Z translation
	10905,  // XZ translation
	10905,  // YZ translation
	13961,  // XYZ translation
	//Corrected numbers
	0,      // no movement
	8716,   // X translation
	8716,   // Y translation
	12326,  // XY translation
	7117,   // Z translation
	11252,  // XZ translation
	11252,  // YZ translation
	14233,  // XYZ translation
	};

const int32_t acceleration_from_pitch[]=
	{
	0,    // Flat
	-124548,    // 1 Slope Up 12.5
	-243318,    // 2 Slope Up 25
	-416016,    // 3 Slope Up 42.5
	-546342,    // 4 Slope Up 60
	 124548,    // 5 Slope Down 12.5
	 243318,    // 6 Slope Down 25
	 416016,    // 7 Slope Down 42.5
	 546342,    // 8 Slope Down 60
	-617604,    // 9 Slope Up 75
	-642000,    // 10 Slope Up 90
	-620172,    // 11 Slope Up 105
	-555972,    // 12 Slope Up 120
	-453894,    // 13 Slope Up 135
	-321000,    // 14 Slope Up 150
	-166278,    // 15 Slope Up 165
	      0,    // 16 Fully Inverted
	 617604,    // 17 Slope Down 75
	 642000,    // 18 Slope Down 90
	 620172,    // 19 Slope Down 105
	 555972,    // 20 Slope Down 120
	 453894,    // 21 Slope Down 135
	 321000,    // 22 Slope Down 150
	 166278,    // 23 Slope Down 165
	-321000,    // 24 Corkscrew Right Up 0
	-555972,    // 25 Corkscrew Right Up 1
	-642000,    // 26 Corkscrew Right Up 2
	-555972,    // 27 Corkscrew Right Up 3
	-321000,    // 28 Corkscrew Right Up 4
	 321000,    // 29 Corkscrew Right Down 4
	 555972,    // 30 Corkscrew Right Down 3
	 642000,    // 31 Corkscrew Right Down 2
	 555972,    // 32 Corkscrew Right Down 1
	 321000,    // 33 Corkscrew Right Down 0
	-321000,    // 34 Corkscrew Left Up 0
	-555972,    // 35 Corkscrew Left Up 1
	-642000,    // 36 Corkscrew Left Up 2
	-555972,    // 37 Corkscrew Left Up 3
	-321000,    // 38 Corkscrew Left Up 4
/*
	-226981,    // 34 Corkscrew Left Up 0
	-393143,    // 35 Corkscrew Left Up 1
	-453963,    // 36 Corkscrew Left Up 2
	-393143,    // 37 Corkscrew Left Up 3
	-226981,    // 38 Corkscrew Left Up 4
*/
	 321000,    // 39 Corkscrew Left Down 4
	 555972,    // 40 Corkscrew Left Down 2
	 642000,    // 41 Corkscrew Left Down 1
	 555972,    // 42 Corkscrew Left Down 1
	 321000,    // 43 Corkscrew Left Down 0
	 -33384,    // 44 Half Helix Up Large
	 -55854,    // 45 Half Helix Up Small
	  33384,    // 46 Half Helix Down Large
	  55854,    // 47 Half Helix Down Small
	 -66768,    // 48 Quarter Helix Up
	  66768,    // 49 Quarter Helix Down
	 -90522,    // 50 Slope Up 8
	-179760,    // 51 Slope Down 16
	-484068,    // 52 Slope Up 50
	  90522,    // 53 Slope Down 8
	 179760,    // 54 Slope Down 16
	 484068,    // 55 Slope Down 50
	 243318,    // 56 Inverting Loop Down 25
	 416016,    // 57 Inverting Loop Down 42.5
	 546342,    // 58 Inverting Loop Down 60
	-110424,    // 59 Slope Up Spiral Lift Hill
};

void calculate_energy_error(track_section_t* track_section,subposition_t* points,int num_points,const char* name)
{
//	for(int i=1;i<6;i++)
//	{
//	printf("%.2f %.2f %.2f\n",CRY(i*M_PI_6)*180/3.14159,CRP(i*M_PI_6)*180/3.14159,CRR(i*M_PI_6)*180/3.14159);
//	}
int length=0;
int64_t energy=0;
	for(int i=0;i<num_points-1;i++)
	{
	int dist=0;
		if(points[i].x!=points[i+1].x)dist|=1;
		if(points[i].y!=points[i+1].y)dist|=2;
		if(points[i].z!=points[i+1].z)dist|=4;
	length+=subposition_translation[dist+8];
	dist=subposition_translation[dist];

	long int acceleration=-acceleration_from_pitch[points[i].pitch_sprite];
	energy+=acceleration*dist;
	}


double correct_energy=0.5*(track_section->curve(track_section->length).position.y-track_section->curve(0).position.y)/CLEARANCE_HEIGHT;
double actual_energy=fabs(energy/(16.0*6554.0*642000.0));
double correct_length=track_section->length/TILE_SIZE;
double actual_length=length/278912.0;

printf("%s:\n",name);
printf("Energy (height units)\tTrue\tActual\tDiff\tError\n");
printf("Energy (height units)\t%.2f\t%.2f\t%.2f\t%.1f%\n",correct_energy,actual_energy,actual_energy-correct_energy,100*(actual_energy/correct_energy-1));
printf("Length (tiles)\t\t%.3f\t%.3f\t%.3f\t%.1f%\n\n",correct_length,actual_length,actual_length-correct_length,100*(actual_length/correct_length-1));
}




void generate_subposition_data(track_section_t* track_section,const char* name,int groups,int reverse)
{
subposition_t subposition_points[MAX_SUBPOSITION_POINTS];
	for(int i=0; i<4; i++)
	{
	int n=generate_view_subposition_data(track_section,groups,i,reverse,subposition_points);
	//calculate_energy_error(track_section,subposition_points,n,name);
	print_subposition_data(subposition_points,n,name,i);
	}
}

track_point_t large_zero_g_roll_left_curve(float distance);

void get_angle()
{
	float dist=(2.25)*TILE_SIZE;
	float lower=0*TILE_SIZE;
	float upper=4*TILE_SIZE;

	for(int i=0; i<100; i++)
	{
		float mid=0.5*(lower+upper);
		track_point_t point=large_zero_g_roll_left_curve(mid);
		if(point.position.z>dist)upper=mid;
		else lower=mid;
	}
	track_point_t point=large_zero_g_roll_left_curve(0.5*(lower+upper));

	float pivot=0.116897727273*TILE_SIZE;

	float roll=atan2(point.normal.x,point.normal.y);
	float y_offset=cos(roll)*pivot*(1.0/sqrt(point.tangent.x*point.tangent.x+point.tangent.z*point.tangent.z)-1.0);

	printf("Position xy: %f %f tiles Height %f clearances (offset %f)\n",point.position.x/TILE_SIZE,point.position.z/TILE_SIZE,point.position.y/CLEARANCE_HEIGHT,(point.position.y-y_offset)/CLEARANCE_HEIGHT);
	printf("Roll %f\n",roll*180/M_PI);
}


int main(int argc,const char** argv)
{
	//get_angle();
	//calc_g_forces(&(track_list_default.small_flat_to_steep_up));
	//calc_g_forces(&(track_list_default.small_flat_to_steep_up_diag));
	//calc_g_forces(&(track_list_default.flat_to_steep_up));
	//calc_g_forces(&(track_list_default.flat_to_steep_up_diag));
	//calc_g_forces(&(track_list_default.dive_loop_45_left));
	//calc_g_forces(&(track_list_default.large_zero_g_roll_left));
	//calc_g_forces(&(track_list_default.large_half_loop_left));
	//generate_subposition_data(&(track_list_default.large_zero_g_roll_left),"LeftEighthDiveLoopUpToOrthogonal",0,0);
	//generate_subposition_data(&(track_list_default.dive_loop_45_left),"LeftEighthDiveLoopUpToOrthogonal",0,0);

	/*
	generate_subposition_data(&(track_list_default.zero_g_roll_left),"LeftZeroGRollUp",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ORTHOGONAL,0);
	generate_subposition_data(&(track_list_default.zero_g_roll_right),"RightZeroGRollUp",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.zero_g_roll_left),"LeftZeroGRollDown",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_BASE,20);
	generate_subposition_data(&(track_list_default.zero_g_roll_right),"RightZeroGRollDown",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_BASE,20);

	generate_subposition_data(&(track_list_default.large_zero_g_roll_left),"LeftLargeZeroGRollUp",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ORTHOGONAL,0);
	generate_subposition_data(&(track_list_default.large_zero_g_roll_right),"RightLargeZeroGRollUp",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ORTHOGONAL,0);
	generate_subposition_data(&(track_list_default.large_zero_g_roll_left),"LeftLargeZeroGRollDown",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ORTHOGONAL,20);
	generate_subposition_data(&(track_list_default.large_zero_g_roll_right),"RightLargeZeroGRollDown",SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ORTHOGONAL,20);


	generate_subposition_data(&(track_list_default.medium_half_loop_left),"LeftMediumHalfLoopUp",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.medium_half_loop_right),"RightMediumHalfLoopUp",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.medium_half_loop_right),"LeftMediumHalfLoopDown",SPRITE_GROUP_BASE,36);
	generate_subposition_data(&(track_list_default.medium_half_loop_left),"RightMediumHalfLoopDown",SPRITE_GROUP_BASE,36);
	*/

	/*
	generate_subposition_data(&(track_list_default.large_turn_left_to_diag_gentle_up),"LeftEighthToDiagUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_to_diag_gentle_up),"RightEighthToDiagUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_to_orthogonal_gentle_up),"LeftEighthToDiagDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_to_orthogonal_gentle_up),"RightEighthToDiagDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_to_orthogonal_gentle_up),"LeftEighthToOrthogonalUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_to_orthogonal_gentle_up),"RightEighthToOrthogonalUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_to_diag_gentle_up),"LeftEighthToOrthogonalDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_to_diag_gentle_up),"RightEighthToOrthogonalDown25",SPRITE_GROUP_BASE,17);
	*/

/*
	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_left_bank_diag),"DiagUp25ToLeftBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_right_bank_diag),"DiagUp25ToRightBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_gentle_up_diag),"DiagLeftBankedUp25ToUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_gentle_up_diag),"DiagRightBankedUp25ToUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_gentle_up_diag),"DiagDown25ToLeftBankedDown25",SPRITE_GROUP_DIAGONAL,17);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_gentle_up_diag),"DiagDown25ToRightBankedDown25",SPRITE_GROUP_DIAGONAL,17);
	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_right_bank_diag),"DiagLeftBankedDown25ToDown25",SPRITE_GROUP_DIAGONAL,17);
	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_left_bank_diag),"DiagRightBankedDown25ToDown25",SPRITE_GROUP_DIAGONAL,17);

	generate_subposition_data(&(track_list_default.left_bank_to_gentle_up_left_bank_diag),"DiagLeftBankedFlatToLeftBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.right_bank_to_gentle_up_right_bank_diag),"DiagRightBankedFlatToRightBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_left_bank_diag),"DiagLeftBankedUp25ToLeftBankedFlat",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_right_bank_diag),"DiagRightBankedUp25ToRightBankedFlat",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_right_bank_diag),"DiagLeftBankedFlatToLeftBankedDown25",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_left_bank_diag),"DiagRightBankedFlatToRightBankedDown25",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.right_bank_to_gentle_up_right_bank_diag),"DiagLeftBankedDown25ToLeftBankedFlat",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.left_bank_to_gentle_up_left_bank_diag),"DiagRightBankedDown25ToRightBankedFlat",SPRITE_GROUP_DIAGONAL,9);

	generate_subposition_data(&(track_list_default.gentle_up_left_bank_diag),"DiagUp25LeftBanked",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_diag),"DiagUp25RightBanked",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_diag),"DiagDown25LeftBanked",SPRITE_GROUP_DIAGONAL,17);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_diag),"DiagDown25RightBanked",SPRITE_GROUP_DIAGONAL,17);

	generate_subposition_data(&(track_list_default.flat_to_gentle_up_left_bank_diag),"DiagFlatToLeftBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.flat_to_gentle_up_right_bank_diag),"DiagFlatToRightBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_flat_diag),"DiagLeftBankedUp25ToFlat",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_flat_diag),"DiagRightBankedUp25ToFlat",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_flat_diag),"DiagFlatToLeftBankedDown25",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_flat_diag),"DiagFlatToRightBankedDown25",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.flat_to_gentle_up_right_bank_diag),"DiagLeftBankedDown25ToFlat",SPRITE_GROUP_DIAGONAL,9);
	generate_subposition_data(&(track_list_default.flat_to_gentle_up_left_bank_diag),"DiagRightBankedDown25ToFlat",SPRITE_GROUP_DIAGONAL,9);

	generate_subposition_data(&(track_list_default.large_turn_left_bank_to_diag_gentle_up),"LeftEighthBankToDiagUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_bank_to_diag_gentle_up),"RightEighthBankToDiagUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_bank_to_orthogonal_gentle_up),"LeftEighthBankToDiagDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_bank_to_orthogonal_gentle_up),"RightEighthBankToDiagDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_bank_to_orthogonal_gentle_up),"LeftEighthBankToOrthogonalUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_bank_to_orthogonal_gentle_up),"RightEighthBankToOrthogonalUp25",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_list_default.large_turn_right_bank_to_diag_gentle_up),"LeftEighthBankToOrthogonalDown25",SPRITE_GROUP_BASE,17);
	generate_subposition_data(&(track_list_default.large_turn_left_bank_to_diag_gentle_up),"RightEighthBankToOrthogonalDown25",SPRITE_GROUP_BASE,17);


	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_left_bank_diag),"DiagUp25ToLeftBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_to_gentle_up_right_bank_diag),"DiagUp25ToRightBankedUp25",SPRITE_GROUP_DIAGONAL,0);
	generate_subposition_data(&(track_list_default.gentle_up_right_bank_to_gentle_up_diag),"DiagDown25ToLeftBankedDown25",SPRITE_GROUP_DIAGONAL,17);
	generate_subposition_data(&(track_list_default.gentle_up_left_bank_to_gentle_up_diag),"DiagDown25ToRightBankedDown25",SPRITE_GROUP_DIAGONAL,17);
*/



	//generate_subposition_data(&(track_list_default.flat_to_steep_up_diag),"DiagFlatToUp60LongBase",SPRITE_GROUP_DIAGONAL,0);
	//generate_subposition_data(&(track_list_default.steep_to_flat_up_diag),"DiagUp60ToFlatLongBase",SPRITE_GROUP_DIAGONAL,0);
	//generate_subposition_data(&(track_list_default.steep_to_flat_up_diag),"DiagFlatToDown60LongBase",SPRITE_GROUP_DIAGONAL,9);
	//generate_subposition_data(&(track_list_default.flat_to_steep_up_diag),"DiagDown60ToFlatLongBase",SPRITE_GROUP_DIAGONAL,49);
	


	//generate_subposition_data(&(track_list_default.large_corkscrew_left),"LargeCorkscrewLeft", SPRITE_GROUP_CORKSCREW|SPRITE_GROUP_ORTHOGONAL,0);

	//generate_subposition_data(&(track_list_default.dive_loop_45_left),"LeftEighthDiveLoopUpToOrthogonal",  SPRITE_GROUP_CORKSCREW,0);
	//generate_subposition_data(&(track_list_default.dive_loop_90_left),"LeftDiveLoop90Up",  SPRITE_GROUP_CORKSCREW,0);

	//int sprites=SPRITE_GROUP_ORTHOGONAL|SPRITE_GROUP_DIAGONAL|SPRITE_GROUP_INLINE_TWIST|SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL|SPRITE_GROUP_DIVE_LOOP;//|SPRITE_GROUP_ZERO_G_ROLLS_DIAGONAL|SPRITE_GROUP_ZERO_G_ROLLS_OTHER;//;//|SPRITE_GROUP_CORKSCREW;//
	//generate_subposition_data(&(track_list_default.dive_loop_45_left),"LeftEighthDiveLoopUpToOrthogonal",sprites,0);
	//generate_subposition_data(&(track_list_default.dive_loop_45_right),"RightEighthDiveLoopUpToOrthogonal",sprites,0);
	//generate_subposition_data(&(track_list_default.dive_loop_45_right),"LeftEighthDiveLoopDownToOrthogonal",sprites,28);
	//generate_subposition_data(&(track_list_default.dive_loop_45_left),"RightEighthDiveLoopDownToOrthogonal",sprites,28);

	//generate_subposition_data(&(track_list_default.dive_loop_90_left),"LeftDiveLoopUp",sprites,0);
	//generate_subposition_data(&(track_list_default.dive_loop_90_right),"RightDiveLoopUp",sprites,0);
	//generate_subposition_data(&(track_list_default.dive_loop_90_right),"LeftDiveLoopDown",sprites,28);
	//generate_subposition_data(&(track_list_default.dive_loop_90_left),"RightDiveLoopDown", sprites,28);

	//generate_subposition_data(&(track_list_default.medium_half_loop_left),"LeftMediumHalfLoopUp",SPRITE_GROUP_BASE,0);



//	generate_subposition_data(&(track_list_default.flat),"Flat",sprites,0);
//	generate_subposition_data(&(track_list_default.gentle),"Gentle",sprites,0);
//	generate_subposition_data(&(track_list_default.steep),"Steep",sprites,0);
//	generate_subposition_data(&(track_list_default.vertical),"Vertical",sprites,0);

/*	int sprites=SPRITE_GROUP_ORTHOGONAL|SPRITE_GROUP_DIAGONAL|SPRITE_GROUP_BASE;
	generate_subposition_data(&(track_sections[S_BEND_LEFT_BANK]),"BankedSBendLeft",sprites,0);
	generate_subposition_data(&(track_sections[S_BEND_RIGHT_BANK]),"BankedSBendRight",sprites,0);

	sprites=SPRITE_GROUP_ORTHOGONAL|SPRITE_GROUP_ZERO_G_ROLLS_ORTHOGONAL;
	generate_subposition_data(&(track_sections[GENTLE_LEFT_BANK_TO_STEEP]),"LeftBankedUp25ToUp60",sprites,0);
	generate_subposition_data(&(track_sections[GENTLE_RIGHT_BANK_TO_STEEP]),"RightBankedUp25ToUp60",sprites,0);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_LEFT_BANK]),"Up60ToLeftBankedUp25",sprites,0);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_RIGHT_BANK]),"Up60ToRightBankedUp25",sprites,0);

	generate_subposition_data(&(track_sections[GENTLE_LEFT_BANK_TO_STEEP]),"Down60ToRightBankedDown25",sprites,33);
	generate_subposition_data(&(track_sections[GENTLE_RIGHT_BANK_TO_STEEP]),"Down60ToLeftBankedDown25",sprites,33);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_LEFT_BANK]),"RightBankedDown25ToDown60",sprites,33);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_RIGHT_BANK]),"LeftBankedDown25ToDown60",sprites,33);


	sprites=SPRITE_GROUP_DIAGONAL;


	generate_subposition_data(&(track_sections[GENTLE_LEFT_BANK_TO_STEEP_DIAG]),"DiagLeftBankedUp25ToUp60",sprites,0);
	generate_subposition_data(&(track_sections[GENTLE_RIGHT_BANK_TO_STEEP_DIAG]),"DiagRightBankedUp25ToUp60",sprites,0);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_LEFT_BANK_DIAG]),"DiagUp60ToLeftBankedUp25",sprites,0);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_RIGHT_BANK_DIAG]),"DiagUp60ToRightBankedUp25",sprites,0);

	generate_subposition_data(&(track_sections[GENTLE_LEFT_BANK_TO_STEEP_DIAG]),"DiagDown60ToRightBankedDown25",sprites,33);
	generate_subposition_data(&(track_sections[GENTLE_RIGHT_BANK_TO_STEEP_DIAG]),"DiagDown60ToLeftBankedUp25",sprites,33);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_LEFT_BANK_DIAG]),"DiagRightBankedDown25ToDown60",sprites,33);
	generate_subposition_data(&(track_sections[STEEP_TO_GENTLE_RIGHT_BANK_DIAG]),"DiagLeftBankedDown25ToDown60",sprites,33);
*/

	generate_subposition_data(&(track_sections[SMALL_TURN_LEFT_STEEP               ]),"LeftQuarterTurn3TilesUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[SMALL_TURN_RIGHT_STEEP              ]),"RightQuarterTurn3TilesUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[SMALL_TURN_RIGHT_STEEP              ]),"LeftQuarterTurn3TilesDown60",SPRITE_GROUP_BASE,81);
	generate_subposition_data(&(track_sections[SMALL_TURN_LEFT_STEEP               ]),"RightQuarterTurn3TilesDown60",SPRITE_GROUP_BASE,81);
	generate_subposition_data(&(track_sections[LARGE_TURN_LEFT_TO_DIAG_STEEP       ]),"LeftEighthToDiagUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[LARGE_TURN_RIGHT_TO_DIAG_STEEP      ]),"RightEighthToDiagUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[LARGE_TURN_RIGHT_TO_ORTHOGONAL_STEEP]),"LeftEighthToDiagDown60",SPRITE_GROUP_BASE,65);
	generate_subposition_data(&(track_sections[LARGE_TURN_LEFT_TO_ORTHOGONAL_STEEP ]),"RightEighthToDiagDown60",SPRITE_GROUP_BASE,65);
	generate_subposition_data(&(track_sections[LARGE_TURN_LEFT_TO_ORTHOGONAL_STEEP ]),"LeftEighthToOrthogonalUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[LARGE_TURN_RIGHT_TO_ORTHOGONAL_STEEP]),"RightEighthToOrthogonalUp60",SPRITE_GROUP_BASE,0);
	generate_subposition_data(&(track_sections[LARGE_TURN_RIGHT_TO_DIAG_STEEP      ]),"LeftEighthToOrthogonalDown60",SPRITE_GROUP_BASE,65);
	generate_subposition_data(&(track_sections[LARGE_TURN_LEFT_TO_DIAG_STEEP       ]),"RightEighthToOrthogonalDown60",SPRITE_GROUP_BASE,65);





//Steep bank 45, 67.5, 90, 16 frames
	return 0;
}
 

//Diagonal steep bank 45 - all offset angles needed, no straight or diagonal

//Diagonal steep bank 67.5 - not really needed for overbanks

//Gentle slope bank 67.5 - all offset angles needed
